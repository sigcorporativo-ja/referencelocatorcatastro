{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/templates/referencelocatorcatastro.html","webpack:///./src/templates/results.html","webpack:///./src/templates/featurepopup.html","webpack:///./src/impl/ol/js/referencelocatorcatastrocontrol.js","webpack:///./src/facade/js/referencelocatorcatastrocontrol.js","webpack:///./src/facade/js/referencelocatorcatastro.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ReferenceLocatorCatastroControl","M","impl","Control","map","html","parameters","utils","isUndefined","ReferenceLocatorCatastroImplControl","exception","options","config_","isNullOrEmpty","NAME","facadeMap_","inputRC_","selectProvincias","selectMunicipios","inputPoligono","inputParcela","ConsultaMunicipioCodigos_","CMC_url","DNPRC_url_","DNPRC_url","CPMRC_url_","CPMRC_url","DNPPP_url_","DNPPP_url","RCCOOR_url_","RCCOOR_url","resultsRCContainer_","resultsParamsContainer_","resultsScrollContainer_","searchingRCResult_","searchingParamsResult_","searchTime_","rcResults_","paramsResults_","scrollIsUp_","draggablePanel","panelMinimized","element_","SEARCHING_CLASS","HIDDEN_RESULTS_CLASS","POPUP_TITLE","layer_","layer","GeoJSON","crs","this","querySelector","addLayers","displayInLayerSwitcher","Promise","success","fail","template","compileSync","setStyle","createCatastroPanel","addEvents_","togglePanel","searchRCContainer","searchParamsContainer","searchRCResults","searchParamsResults","searchRCTab","searchParamsTab","addEventListener","classList","contains","add","remove","onRCSearch","activeSearch","activeInfo","clearResults","onProvinciaSelect","e","onParamsSearch","tooltip","setAttribute","icon","order","parentNode","deactivate","activate","element","on","evt","COMPLETED","clearClick_","srs","getProjection","code","remote","SRS","Coordenada_X","coord","Coordenada_Y","then","res","showInfoFromURL_","jsonp","response","coordinates","error","infos","info","text","formatedInfo","formatInfo_","push","tab","title","content","join","popup","getPopup","Popup","addTab","addPopup","getCoordinate","hasExternalContent","getTabs","forEach","removeTab","removePopup","dialog","ldtNode","valuePopup","codProv","codMun","rootElement","DOMParser","parseFromString","getElementsByTagName","childNodes","nodeValue","coordNode","pc1Node","pc2Node","substring","link","beautifyAttribute","panelContent","style","display","preventDefault","type","keyCode","inputRC","substr","searchUrl","addParameters","Provincia","Municipio","RC","search_","showResults_","CodigoProvincia","CodigoMunicipio","CodigoMunicipioINE","Poligono","Parcela","container","searchingResult","processor","appendChild","acceptOVCSW","xml","errorCtlNode","cuerr","undefined","errorDescTxt","err","xmlResults","pcNode","geoNode","xcenNode","ycenNode","srsNode","attributes","rcId","coords","xcen","ycen","results","getLayer","clear","resultsTemplateVars","parseRCResultsForTemplate_","parseParamsResultsForTemplate_","resolve","resultTemplate","drawResults","templateResults","vars","resultsHtmlElements","querySelectorAll","ilen","length","item","removeEventListener","resultClick_","zoomToResults","btnResults","resultsClick_","innerHTML","scrollIntoView","getElementsByClassName","fire","append","docs","parseCPMRCResults","unshift","total","partial","notResutls","query","rcNode","descripcion","cnValue","lrcdnpNode","rcdnpNode","dtNode","npNode","nmNode","lorusNode","npaNode","cpajNode","biNode","idbiNode","pc1Value","pc2Value","paramsId","docsRC","window","WIDTH","config","MOBILE_WIDTH","currentTarget","id","resultClick","areasContainer","target","classlist","toggle","provinceCode","CodigoMunicipioIne","loadMunicipiosSelect","clearMunicipiosSelect","select","firstChild","removeChild","option","document","createElement","muniNodes","locat","features","doc","Feature","geometry","properties","addFeatures","bbox","getFeaturesExtent","setBbox","rcid","feature","getFeatureById","selectedFeatures_","getGeometry","unselectResults","selectFeatures","setCenter","setZoom","noPanMapIfOutOfView","featureForTemplate","parseFeaturesForTemplate_","htmlAsText","templatePopUp","parseToHtml","featureTabOpts","panMapIfOutOfView","ani","parseFloat","DESTROY","featuresTemplate","getAttributes","keys","elem","featureTemplate","keepPopup","activated","someCtlActive","getControls","some","control","CLICK","buildUrl_","un","obj","equals","getMapImpl","removeControl","ReferenceLocatorCatastro","Plugin","userParameters","map_","controls_","catastroLayer_","defectRCCOOR","defectCMC","defectDNPRC","defectCPMRC","defectDNPP","catastroWMS","metadata_","api","metadata","panel_","ui","Panel","className","collapsedButtonClass","collapsible","position","TL","ADDED_TO_MAP","enableTouchScroll","addControls","addPanels","wms_url","WMS","url","legend","transparent","tiled","addWMS","that","removeControls","plugin","M$plugin$ReferenceLocatorCatastro","M$control$ReferenceLocatorCatastroControl","M$impl$control$ReferenceLocatorCatastroControl"],"mappings":"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","file":"referencelocatorcatastro.ol.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","module.exports = \"<div id=\\\"referencelocatorcatastro-id\\\" class=\\\"m-control m-container m-referencelocatorcatastro-container\\\">\\n    <div class=\\\"header\\\">\\n        <!-- TITLE -->\\n        <!--<div class=\\\"titleBusquedaCatastral\\\">Búsqueda catastral</div>-->\\n        <button id=\\\"m-referencelocatorcatastro-button\\\" class=\\\"icon-navigation-busqueda-catastral\\\" title=\\\"Búsqueda catastral\\\"></button>\\n        <button id=\\\"m-catastrogetinfo-button\\\" class=\\\"g-cartografia-catastrogetinfo-button\\\" title=\\\"Consultar datos catastrales\\\"></button>\\n        <button id=\\\"m-catastroclear-button\\\" class=\\\"g-cartografia-papelera\\\" title=\\\"Limpiar resultados\\\"></button>\\n    </div>\\n    <div class=\\\"m-tabs-referencelocatorcatastro-container\\\">\\n        <ul id=\\\"m-tabs-referencelocatorcatastro\\\" class=\\\"group\\\">\\n            <li><a class=\\\"activated\\\">Referencia Catastral</a></li>\\n            <li><a>Búsqueda por polígono y parcela</a></li>\\n        </ul>\\n        <div id=\\\"m-tabs-referencelocatorcatastro-content\\\">\\n            <!-- Parámetros de búsqueda -->\\n            <div id=\\\"m-searchRC-container\\\" class=\\\"m-searchRC-tab m-tabcontent-referencelocatorcatastro show\\\">\\n                <input type=\\\"text\\\" id=\\\"m-searchRC-input\\\" class=\\\"g-cartografia-searchRC-input\\\" maxlength=\\\"20\\\" placeholder=\\\"Introduzca los 14 ó 20 dígitos de la RC\\\"></input>\\n                <div id=\\\"button-rc\\\" class=\\\"button\\\">\\n                    <button id=\\\"m-searchRC-button\\\" class=\\\"search\\\" title=\\\"Buscar\\\">\\n                        <i class=\\\"g-cartografia-zoom m-search-btn\\\"></i>Buscar\\n                    </button>\\n                    <button id=\\\"m-clearRC-button\\\" class=\\\"search\\\" title=\\\"Limpiar Resultados\\\">\\n                        <i class=\\\"g-cartografia-papelera m-search-btn\\\"></i>Limpiar\\n                    </button>\\n                </div>\\n            </div>\\n            <div id=\\\"m-searchParams-container\\\" class=\\\"m-searchParams-tab m-tabcontent-referencelocatorcatastro\\\">\\n                <label id=\\\"m-searchParamsProvincia-label\\\" class=\\\"g-cartografia-searchParamsProvincia-label\\\">Provincia:</label>\\n                <select id=\\\"m-searchParamsProvincia-select\\\" name=\\\"Provincias\\\" class=\\\"g-cartografia-searchParamsProvincia-select\\\">\\n                    <option value=\\\"0\\\">Seleccione una provincia</option>\\n                    <option value=\\\"04\\\">ALMERÍA</option>\\n                    <option value=\\\"11\\\">CÁDIZ</option>\\n                    <option value=\\\"14\\\">CÓRDOBA</option>\\n                    <option value=\\\"18\\\">GRANADA</option>\\n                    <option value=\\\"21\\\">HUELVA</option>\\n                    <option value=\\\"23\\\">JAÉN</option>\\n                    <option value=\\\"29\\\">MÁLAGA</option>\\n                    <option value=\\\"41\\\">SEVILLA</option>\\n                </select>\\n                <br>\\n                <label id=\\\"m-searchParamsMunicipio-label\\\" class=\\\"g-cartografia-searchParamsMunicipio-label\\\">Municipio:</label>\\n                <select id=\\\"m-searchParamsMunicipio-select\\\" name=\\\"Municipios\\\" class=\\\"g-cartografia-searchParamsMunicipio-select\\\">\\n                    <option value=\\\"0\\\">Seleccione un municipio</option>\\n                </select>\\n                <br>\\n                <label id=\\\"m-searchParamsPoligono-label\\\" class=\\\"g-cartografia-searchParamsPoligono-label\\\">Polígono:</label>\\n                <input type=\\\"text\\\" id=\\\"m-searchParamsPoligono-input\\\" class=\\\"g-cartografia-searchParamsPoligono-input\\\" placeholder=\\\"Introduzca un polígono\\\">\\n                <br>\\n                <label id=\\\"m-searchParamsParcela-label\\\" class=\\\"g-cartografia-searchParamsParcela-label\\\">Parcela:</label> <input type=\\\"text\\\" id=\\\"m-searchParamsParcela-input\\\" class=\\\"g-cartografia-searchParamsParcela-input\\\" placeholder=\\\"Introduzca una parcela\\\">\\n                <div id=\\\"button-params\\\" class=\\\"button\\\">\\n                    <button id=\\\"m-searchParams-button\\\" class=\\\"search\\\" title=\\\"Buscar\\\">\\n                        <i class=\\\"g-cartografia-zoom m-search-btn\\\"></i>Buscar\\n                    </button>\\n\\n                    <button id=\\\"m-clearParams-button\\\" class=\\\"search\\\" title=\\\"Limpiar Resultados\\\">\\n                        <i class=\\\"g-cartografia-papelera m-search-btn\\\"></i>Limpiar\\n                    </button>\\n                </div>\\n            </div>\\n        </div>\\n        <!-- Resultados de búsqueda -->\\n        <div id=m-referencelocatorcatastro-results>\\n            <!-- results searchRC -->\\n            <div id=\\\"m-searchRC-results\\\" class=\\\"m-searchRC m-tabcontent-referencelocatorcatastro results-panel show\\\">\\n                <div id=\\\"m-searching-result-searchRC\\\" class=\\\"m-searching-result g-cartografia-spinner\\\"></div>\\n            </div>\\n            <!-- results searchParams -->\\n            <div id=\\\"m-searchParams-results\\\" class=\\\"m-searchParams m-tabcontent-referencelocatorcatastro results-panel\\\">\\n                <div id=\\\"m-searching-result-searchParams\\\" class=\\\"m-searching-result g-cartografia-spinner\\\"></div>\\n            </div>\\n        </div>\\n    </div>\\n</div>\";","module.exports = \"<div class=\\\"catastro-results-panels\\\">\\n    {{#if partial}}\\n        <div class=\\\"partial\\\">\\n            <p>No se han encontrado resultados para la búsqueda.</p>\\n        </div>\\n    {{/if}}\\n    <div class=\\\"results\\\" id=\\\"m-catastro-results-scroll\\\">\\n        {{#each docs}}\\n            <div id=\\\"{{rcId}}\\\" class=\\\"result\\\">\\n                {{#each attributes}}\\n                    <table>\\n                        <tbody>\\n                            <tr>\\n                                <td class=\\\"key\\\">{{key}}</td>\\n                                <td class=\\\"value{{#oneword value}} m-wordbreak{{/oneword}}\\\">{{{value}}}</td>\\n                            </tr>\\n                        </tbody>\\n                    </table>\\n                {{/each}}\\n            </div>\\n        {{/each}}\\n    </div>\\n    {{#eq docs.length 0}}\\n        <div class=\\\"results\\\">\\n            <div class=\\\"partial\\\">No se han encontrado resultados para la búsqueda \\\"{{query}}\\\".</div>\\n        </div>\\n    {{/eq}}\\n    <div class=\\\"page\\\" id=\\\"currentPage\\\">\\n        <span class=\\\"found\\\" id=\\\"m-catastro-page-found\\\">{{docs.length}}</span> de <span class=\\\"total\\\">{{total}}</span>\\n    </div>\\n</div>\";","module.exports = \"<div class=\\\"m-catastrogetinfo-content\\\">\\n    {{#each features}}\\n        <div class=\\\"result\\\">\\n            {{#each attributes}}\\n                <table>\\n                    <tr>\\n                        <td class=\\\"key\\\"><b>{{key}}</b></td>\\n                        <td class=\\\"value{{#oneword value}} m-wordbreak{{/oneword}}\\\">{{{value}}}</td>\\n                    </tr>\\n                </table>\\n            {{/each}}\\n        </div>\\n        <div class=\\\"m-separator\\\"></div>\\n    {{/each}}\\n</div>\";","/**\n * @module M/impl/control/ReferenceLocatorCatastroControl\n */\nexport default class ReferenceLocatorCatastroControl extends M.impl.Control {\n  /**\n   * This function adds the control to the specified map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the plugin\n   * @param {HTMLElement} html of the plugin\n   * @api stable\n   */\n  addTo(map, html) {\n    super.addTo(map, html);\n  }\n}\n","/**\n * @module M/control/ReferenceLocatorCatastroControl\n */\n\nimport ReferenceLocatorCatastroImplControl from 'impl/referencelocatorcatastrocontrol';\nimport template from 'templates/referencelocatorcatastro';\nimport templateResults from 'templates/results';\nimport templatePopUp from 'templates/featurepopup';\n\nexport default class ReferenceLocatorCatastroControl extends M.Control {\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a PluginControl\n   * control\n   *\n   * @constructor\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(parameters) {\n    if (M.utils.isUndefined(ReferenceLocatorCatastroImplControl)) {\n      M.exception('La implementación usada no puede crear controles ReferenceLocatorCatastroControl.');\n    }\n\n    const impl = new ReferenceLocatorCatastroImplControl();\n    super(impl, 'ReferenceLocatorCatastro');\n\n    if (parameters) {\n      this.options = (parameters || {});\n      this.config_ = (parameters || {});\n    } else {\n      M.exception('ReferenceLocatorCatastroControl: configuración no válida.');\n    }\n\n    if (M.utils.isUndefined(this.options.name) || M.utils.isNullOrEmpty(this.options.name)) {\n      this.options.name = this.NAME || 'ReferenceLocatorCatastro';\n    }\n\n    this.facadeMap_ = null;\n\n    /**\n     * Input element for RC\n     * @private\n     * @type {HTMLElement}\n     */\n    this.inputRC_ = null;\n\n    /**\n     * Select element for Provincias\n     * @private\n     * @type {HTMLElement}\n     */\n    this.selectProvincias = null;\n\n    /**\n     * Select element for Municipios\n     * @private\n     * @type {HTMLElement}\n     */\n    this.selectMunicipios = null;\n\n    /**\n     * Input element for Poligono\n     * @private\n     * @type {HTMLElement}\n     */\n    this.inputPoligono = null;\n\n    /**\n     * Input element for Parcela\n     * @private\n     * @type {HTMLElement}\n     */\n    this.inputParcela = null;\n\n    /**\n     * Url for \"consulta de municipios para una provincia\"\n     * @private\n     * @type {String}\n     */\n    this.ConsultaMunicipioCodigos_ = this.config_.CMC_url;\n\n    /**\n     * Url for \"consulta de datos no protegidos para un inmueble por su referencia catastral\"\n     * @private\n     * @type {String}\n     */\n    this.DNPRC_url_ = this.config_.DNPRC_url;\n\n    /**\n     * Url for \"consulta de coordenadas por Provincia, Municipio y Referencia Catastral\"\n     * @private\n     * @type {String}\n     */\n    this.CPMRC_url_ = this.config_.CPMRC_url;\n\n    /**\n     * Url for \"consulta de datos no protegidos para un inmueble por su polígono parcela\"\n     * @private\n     * @type {String}\n     */\n    this.DNPPP_url_ = this.config_.DNPPP_url;\n\n    /**\n     * Url for \"consulta de Referencia Catastral por Coordenadas\"\n     * @private\n     * @type {String}\n     */\n    this.RCCOOR_url_ = this.config_.RCCOOR_url;\n\n    /**\n     * Container of the results\n     * @private\n     * @type {HTMLElement}\n     */\n    this.resultsRCContainer_ = null;\n\n    /**\n     * Container of the results\n     * @private\n     * @type {HTMLElement}\n     */\n    this.resultsParamsContainer_ = null;\n\n    /**\n     * Container of the results to scroll\n     * @private\n     * @type {HTMLElement}\n     */\n    this.resultsScrollContainer_ = null;\n\n    /**\n     * Searching result\n     * @private\n     * @type {HTMLElement}\n     */\n    this.searchingRCResult_ = null;\n\n    /**\n     * Searching result\n     * @private\n     * @type {HTMLElement}\n     */\n    this.searchingParamsResult_ = null;\n\n    /**\n     * Timestamp of the search to abort old requests\n     * @private\n     * @type {Nunber}\n     */\n    this.searchTime_ = 0;\n\n    /**\n     * Results of the search\n     * @private\n     * @type {Array<Object>}\n     */\n    this.rcResults_ = [];\n\n    /**\n     * Results of the search\n     * @private\n     * @type {Array<Object>}\n     */\n    this.paramsResults_ = [];\n\n    /**\n     * Flag that indicates the scroll is up\n     * @private\n     * @type {Boolean}\n     */\n    this.scrollIsUp_ = true;\n\n    /**\n     * Draggable panel to show results\n     * @private\n     * @type {Object}\n     */\n    this.draggablePanel = null;\n\n    /**\n     * Indicates if the panel is minimized\n     * @private\n     * @type {Boolean}\n     */\n    this.panelMinimized = false;\n\n    /**\n     * Main control's html element\n     * @private\n     * @type {HTMLElement}\n     */\n    this.element_ = null;\n\n    /**\n     * Name of searching css class\n     * @const\n     * @type {string}\n     * @public\n     * @api stable\n     */\n    this.SEARCHING_CLASS = 'm-searching';\n\n    /**\n     * Name of hidden css class\n     * @const\n     * @type {string}\n     * @public\n     * @api stable\n     */\n    this.HIDDEN_RESULTS_CLASS = 'hidden';\n\n    /**\n     * Title for the popup\n     * @const\n     * @type {string}\n     * @public\n     * @api stable\n     */\n    this.POPUP_TITLE = 'Información catastral';\n\n    /**\n     * Result's layer. Invisible on TOC.\n     * @private\n     * @type {M.layer}\n     */\n    this.layer_ = new M.layer.GeoJSON({ name: 'Localizador Catastral', crs: '25830' });\n  }\n\n  /**\n   * This function adds events listeners to html elements\n   *\n   * @public\n   * @function\n   * @param {HTMLElement} element\n   * @api stable\n   */\n  addEvents_(html) {\n    this.element_ = html;\n\n    this.resultsRCContainer_ = this.element_.querySelector('div#m-searchRC-results');\n    this.searchingRCResult_ = this.element_.querySelector('div#m-searchRC-results > div#m-searching-result-searchRC');\n    this.resultsParamsContainer_ = this.element_.querySelector('div#m-searchParams-results');\n    this.searchingParamsResult_ = this.element_.querySelector('div#m-searchParams-results > div#m-searching-result-searchParams');\n  }\n\n  /**\n   * This function creates the view\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  createView(map) {\n    this.facadeMap_ = map;\n    this.facadeMap_.addLayers(this.layer_);\n    this.layer_.displayInLayerSwitcher = false;\n\n    return new Promise((success, fail) => {\n      const html = M.template.compileSync(template);\n      this.setStyle(html, this.options);\n      this.element_ = html;\n      this.createCatastroPanel();\n      this.addEvents_(this.element_);\n      this.togglePanel();\n      success(html);\n    });\n  }\n\n  /**\n   * This function compiles the template and makes a panel\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  createCatastroPanel() {\n    const searchRCContainer = this.element_.querySelector('div#m-searchRC-container');\n    const searchParamsContainer = this.element_.querySelector('div#m-searchParams-container');\n    const searchRCResults = this.element_.querySelector('div#m-searchRC-results');\n    const searchParamsResults = this.element_.querySelector('div#m-searchParams-results');\n    const searchRCTab = this.element_.querySelector('ul#m-tabs-referencelocatorcatastro > li:nth-child(1) > a');\n    const searchParamsTab = this.element_.querySelector('ul#m-tabs-referencelocatorcatastro > li:nth-child(2) > a');\n\n    searchRCTab.addEventListener('click', () => {\n      if (!searchRCTab.classList.contains('activated')) {\n        searchRCTab.classList.add('activated');\n        searchParamsTab.classList.remove('activated');\n        searchRCContainer.classList.add('show');\n        searchRCResults.classList.add('show');\n        searchParamsResults.classList.remove('show');\n        searchParamsContainer.classList.remove('show');\n      }\n    });\n\n    searchParamsTab.addEventListener('click', () => {\n      if (!searchParamsTab.classList.contains('activated')) {\n        searchParamsTab.classList.add('activated');\n        searchRCTab.classList.remove('activated');\n        searchRCContainer.classList.remove('show');\n        searchRCResults.classList.remove('show');\n        searchParamsResults.classList.add('show');\n        searchParamsContainer.classList.add('show');\n      }\n    });\n\n    this.inputRC_ = this.element_.querySelector('#m-searchRC-input');\n    this.inputRC_.addEventListener('keyup', this.onRCSearch.bind(this));\n\n    const catstroSearch = this.element_.querySelector('#m-referencelocatorcatastro-button');\n    catstroSearch.addEventListener('click', this.activeSearch.bind(this));\n\n    const castastroInfo = this.element_.querySelector('#m-catastrogetinfo-button');\n    castastroInfo.addEventListener('click', this.activeInfo.bind(this));\n\n    const buttonClear = this.element_.querySelector('#m-catastroclear-button');\n    buttonClear.addEventListener('click', this.clearResults.bind(this));\n\n    this.selectProvincias = this.element_.querySelector('#m-searchParamsProvincia-select');\n    this.selectProvincias.addEventListener('change', this.onProvinciaSelect.bind(this));\n\n    this.selectMunicipios = this.element_.querySelector('#m-searchParamsMunicipio-select');\n    this.inputPoligono = this.element_.querySelector('#m-searchParamsPoligono-input');\n    this.inputParcela = this.element_.querySelector('#m-searchParamsParcela-input');\n\n    const buttonRCSearch = this.element_.querySelector('#m-searchRC-button');\n    buttonRCSearch.addEventListener('click', this.onRCSearch.bind(this));\n\n    const buttonParamsSearch = this.element_.querySelector('#m-searchParams-button');\n    buttonParamsSearch.addEventListener('click', e => this.onParamsSearch(e));\n\n    const buttonClearRC = this.element_.querySelector('#m-clearRC-button');\n    buttonClearRC.addEventListener('click', this.clearResults.bind(this));\n\n    const buttonClearParams = this.element_.querySelector('#m-clearParams-button');\n    buttonClearParams.addEventListener('click', this.clearResults.bind(this));\n  }\n\n  /**\n   * This function sets user defined style options to button\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  setStyle(html, options) {\n    if (!M.utils.isUndefined(options.tooltip) && !M.utils.isNullOrEmpty(options.tooltip)) {\n      html.querySelector('button').setAttribute('title', options.tooltip);\n    }\n    if (!M.utils.isUndefined(options.icon) && !M.utils.isNullOrEmpty(options.icon)) {\n      html.querySelector('button').setAttribute('class', options.icon);\n    }\n    if (!M.utils.isUndefined(options.order) && !M.utils.isNullOrEmpty(options.order)) {\n      html.querySelector('button').parentNode.setAttribute('style', `order: ${options.order}`);\n    }\n  }\n\n  /**\n   * Set search control active\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  activeSearch() {\n    this.deactivate();\n    this.togglePanel();\n    const classList = this.element_.querySelector('#m-referencelocatorcatastro-button').classList;\n    if (classList.contains('activated')) {\n      classList.remove('activated');\n    } else {\n      classList.add('activated');\n    }\n  }\n\n  /**\n   * Set catastro info button active\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  activeInfo() {\n    if (this.panelMinimized === false) {\n      this.togglePanel();\n    }\n    this.activate();\n  }\n\n  /**\n   * This function adds clear and close events listener to element\n   *\n   * @public\n   * @function\n   * @param {HTMLElement} element\n   * @api stable\n   * @export\n   */\n  addClearEvents(element) {\n    this.on(M.evt.COMPLETED, () => {\n      element.classList.add('shown');\n    });\n\n    const buttonClearRC = element.querySelector('#m-clearRC-button');\n    buttonClearRC.addEventListener('click', this.clearResults.bind(this));\n\n    const buttonClearParams = element.querySelector('#m-clearParams-button');\n    buttonClearParams.addEventListener('click', this.clearResults.bind(this));\n\n    const buttonClose = element.querySelector('#dialog-close-catastro');\n    buttonClose.addEventListener('click', this.clearResults.bind(this));\n  }\n\n  /**\n   * This function clears selects, inputs and result info from panel\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  clearResults() {\n    this.clearClick_();\n  }\n\n  /**\n   * This function builds the query URL and shows results\n   *\n   * @private\n   * @function\n   * @param {ol.MapBrowserPointerEvent} evt - Browser point event\n   */\n  buildUrl_(evt) {\n    const options = {\n      jsonp: true,\n    };\n\n    const srs = this.facadeMap_.getProjection().code;\n\n    M.remote.get(this.RCCOOR_url_, {\n      SRS: srs,\n      Coordenada_X: evt.coord[0],\n      Coordenada_Y: evt.coord[1],\n    }).then((res) => {\n      this.showInfoFromURL_(res, evt.coord);\n    }, options);\n  }\n\n  /**\n   * This function displays information in a popup\n   *\n   * @private\n   * @function\n   * @param {XML} response - response from the petition\n   * @param {array} coordinate - Coordinate position onClick\n   */\n  showInfoFromURL_(response, coordinates) {\n    // TODO: Si existe una capa KML en el punto donde se ha pinchado, no se respetara su popup, ya\n    // que las coordenadas del mismo seran las del kml,\n    // y es muy probable que no coincidan con las del\n    // click, ya que para kmls se trabaja con un margen amplio de pixeles\n    if ((response.code === 200) && (response.error === false)) {\n      const infos = [];\n      const info = response.text;\n      const formatedInfo = this.formatInfo_(info);\n      infos.push(formatedInfo);\n\n      const tab = {\n        icon: 'g-cartografia-pin',\n        title: this.POPUP_TITLE,\n        content: infos.join(''),\n      };\n\n      let popup = this.facadeMap_.getPopup();\n\n      if (M.utils.isNullOrEmpty(popup)) {\n        popup = new M.Popup();\n        popup.addTab(tab);\n        this.facadeMap_.addPopup(popup, coordinates);\n      } else if (popup.getCoordinate()[0] === coordinates[0] && popup.getCoordinate()[1] === coordinates[1]) {\n        // Si es un popup que está en la misma coordenada\n        // Vemos si tiene pestañas de otros controles\n        let hasExternalContent = false;\n        popup.getTabs().forEach((t) => {\n          if (t.title !== this.POPUP_TITLE) {\n            hasExternalContent = true;\n          } else {\n            popup.removeTab(t);\n          }\n        });\n        if (hasExternalContent) {\n          popup.addTab(tab);\n        } else {\n          // Es del mismo catastro, podemos borrarlo\n          popup = new M.Popup();\n          popup.addTab(tab);\n          this.facadeMap_.addPopup(popup, coordinates);\n        }\n      } else {\n        popup = new M.Popup();\n        popup.addTab(tab);\n        this.facadeMap_.addPopup(popup, coordinates);\n      }\n    } else {\n      this.facadeMap_.removePopup();\n      M.dialog.error('MAPEA: No es posible establecer la conexión con el servidor de Catastro.');\n    }\n  }\n\n  /**\n   * This function formats the response\n   *\n   * @param {string} info - Information to formatting\n   * @returns {string} information - Formatted information\n   * @private\n   * @function\n   */\n  formatInfo_(info) {\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(info, 'text/xml');\n    let ldtNode;\n    let valuePopup;\n    let codProv;\n    let codMun;\n\n    const rootElement = xmlDoc.getElementsByTagName('consulta_coordenadas')[0];\n    const controlNode = rootElement.getElementsByTagName('control')[0];\n    const errorCtlNode = controlNode.getElementsByTagName('cuerr')[0].childNodes[0].nodeValue;\n    if (errorCtlNode === '1') {\n      const errorNode = rootElement.getElementsByTagName('lerr')[0];\n      const errorDesc = errorNode.getElementsByTagName('err')[0];\n      const errorDescTxt = errorDesc.getElementsByTagName('des')[0].childNodes[0].nodeValue;\n      valuePopup = errorDescTxt;\n    } else {\n      const coordenadasNode = rootElement.getElementsByTagName('coordenadas')[0];\n      const coordNode = coordenadasNode.getElementsByTagName('coord')[0];\n      const pcNode = coordNode.getElementsByTagName('pc')[0];\n      const pc1Node = pcNode.getElementsByTagName('pc1')[0].childNodes[0].nodeValue;\n      const pc2Node = coordNode.getElementsByTagName('pc2')[0].childNodes[0].nodeValue;\n\n      // Obtenemos códigos de provincia y municipio\n      codProv = pc1Node.substring(0, 2);\n      codMun = pc1Node.substring(2, 5);\n\n      ldtNode = coordNode.getElementsByTagName('ldt')[0].childNodes[0].nodeValue;\n      valuePopup = pc1Node + pc2Node;\n    }\n\n    // Sacar a variable la url\n    const link = `https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCConCiud.aspx?UrbRus=&RefC=${valuePopup}&esBice=&RCBice1=&RCBice2=&DenoBice=&from=OVCBusqueda&pest=rc&RCCompleta=${valuePopup}&final=&del=${codProv}&mun=${codMun}`;\n\n    const formatedInfo = `${M.utils.beautifyAttribute('Información Catastral')}\n    <div class='divinfo'>\n    <table class='mapea-table'>\n    <tbody>\n    <tr><td class='header' colspan='4'></td></tr>\n    <tr><td class='key'><b>${M.utils.beautifyAttribute('Referencia catastral')}</b></td><td class='value'></b>\n    <a href='${link}' target='_blank'>${valuePopup}</a></td></tr>\n    <tr><td class='key'><b>${M.utils.beautifyAttribute('Descripción')}</b></td>\n    <td class='value'>${ldtNode}</td></tr>\n    </tbody></table></div>`;\n\n    return formatedInfo;\n  }\n\n  /**\n   * Toggle panel\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  togglePanel() {\n    const panelContent = this.element_.querySelector('.m-tabs-referencelocatorcatastro-container');\n    if (this.panelMinimized === false) {\n      this.panelMinimized = true;\n      panelContent.style.display = 'none';\n    } else {\n      this.panelMinimized = false;\n      panelContent.style.display = 'inline';\n    }\n  }\n\n  /**\n   * Handler for search with RC button\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  onRCSearch(evt) {\n    evt.preventDefault();\n    if ((evt.type !== 'keyup') || (evt.keyCode === 13)) {\n      let inputRC = this.inputRC_ && this.inputRC_.value;\n      if (M.utils.isNullOrEmpty(inputRC)) {\n        M.dialog.info('Debe introducir una referencia catastral');\n      } else {\n        inputRC = inputRC.substr(0, 14);\n        const searchUrl = M.utils.addParameters(this.CPMRC_url_, {\n          Provincia: '',\n          Municipio: '',\n          SRS: this.facadeMap_.getProjection().code,\n          RC: inputRC,\n        });\n        this.search_(searchUrl, this.resultsRCContainer_, this.searchingRCResult_, this.showResults_);\n      }\n    }\n  }\n\n  /**\n   * Handler for search with params button\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  onParamsSearch(evt) {\n    evt.preventDefault();\n\n    if ((evt.type !== 'keyup') || (evt.keyCode === 13)) {\n      if (M.utils.isNullOrEmpty(this.selectProvincias.value) || this.selectProvincias.value === '0') {\n        M.dialog.info('Debe seleccionar una provincia.');\n        return;\n      }\n      if (M.utils.isNullOrEmpty(this.selectMunicipios.value) || this.selectMunicipios.value === '0') {\n        M.dialog.info('Debe seleccionar un municpio.');\n        return;\n      }\n      if (M.utils.isNullOrEmpty(this.inputPoligono.value)) {\n        M.dialog.info('Debe introducir un polígono.');\n        return;\n      }\n      if (M.utils.isNullOrEmpty(this.inputParcela.value)) {\n        M.dialog.info('Debe introducir una parcela.');\n        return;\n      }\n\n      const searchUrl = M.utils.addParameters(this.DNPPP_url_, {\n        CodigoProvincia: this.selectProvincias.value,\n        CodigoMunicipio: this.selectMunicipios.value,\n        CodigoMunicipioINE: '',\n        Poligono: this.inputPoligono.value,\n        Parcela: this.inputParcela.value,\n      });\n      this.search_(searchUrl, this.resultsParamsContainer_, this.searchingParamsResult_, this.showResults_);\n    }\n  }\n\n  /**\n   * Does the GET petition to search\n   *\n   * @private\n   * @function\n   */\n  search_(searchUrl, container, searchingResult, processor) {\n    container.appendChild(searchingResult);\n    this.element_.classList.add(this.SEARCHING_CLASS);\n\n    M.remote.get(searchUrl).then((response) => {\n      const success = this.acceptOVCSW(response);\n      if (success) {\n        processor.call(this, response.xml, container);\n      }\n      this.element_.classList.remove(this.SEARCHING_CLASS);\n    });\n  }\n\n  /**\n   * Checks if response is valid\n   *\n   * @private\n   * @function\n   */\n  acceptOVCSW(response) {\n    let success = true;\n    try {\n      if ((response.code === 200) && (response.error === false)) {\n        const results = response.xml;\n        const rootElement = results.childNodes[0];\n        const controlNode = rootElement.getElementsByTagName('control')[0];\n        const errorCtlNode = controlNode.getElementsByTagName('cuerr')[0];\n        let cuerr = '0';\n        if (errorCtlNode !== undefined) {\n          cuerr = errorCtlNode.childNodes[0].nodeValue;\n        }\n        if (cuerr === '1') {\n          const errorNode = rootElement.getElementsByTagName('lerr')[0];\n          const errorDesc = errorNode.getElementsByTagName('err')[0];\n          const errorDescTxt = errorDesc.getElementsByTagName('des')[0].childNodes[0].nodeValue;\n          this.element_.classList.remove(this.SEARCHING_CLASS);\n          success = false;\n          M.dialog.info(errorDescTxt);\n        }\n      } else {\n        success = false;\n        M.dialog.error('MAPEA: No es posible establecer la conexión con el servidor de Catastro.');\n      }\n    } catch (err) {\n      success = false;\n      M.exception(`La respuesta no es un JSON válido: ${err}.`);\n    }\n    return success;\n  }\n\n  /**\n   * Parses CPMRC results\n   *\n   * @private\n   * @function\n   */\n  parseCPMRCResults(xmlResults) {\n    const rootElement = xmlResults.getElementsByTagName('consulta_coordenadas')[0];\n    const coordenadasNode = rootElement.getElementsByTagName('coordenadas')[0];\n    const coordNode = coordenadasNode.getElementsByTagName('coord')[0];\n\n    const pcNode = coordNode.getElementsByTagName('pc')[0];\n    const pc1Node = pcNode.getElementsByTagName('pc1')[0].childNodes[0].nodeValue;\n    const pc2Node = pcNode.getElementsByTagName('pc2')[0].childNodes[0].nodeValue;\n\n    const geoNode = coordNode.getElementsByTagName('geo')[0];\n    const xcenNode = geoNode.getElementsByTagName('xcen')[0].childNodes[0].nodeValue;\n    const ycenNode = geoNode.getElementsByTagName('ycen')[0].childNodes[0].nodeValue;\n    const srsNode = geoNode.getElementsByTagName('srs')[0].childNodes[0].nodeValue;\n\n    const ldtNode = coordNode.getElementsByTagName('ldt')[0].childNodes[0].nodeValue;\n\n    return {\n      attributes: [{\n        key: 'Referencia Catastral',\n        value: pc1Node + pc2Node,\n      }, {\n        key: 'Descripción',\n        value: ldtNode,\n      }],\n      rcId: `rc_${pc1Node}${pc2Node}`,\n      coords: [{\n        xcen: xcenNode,\n        ycen: ycenNode,\n        srs: srsNode,\n      }],\n    };\n  }\n\n  /**\n   * This function parses results and compiles template\n   * with vars to show results\n   *\n   * @private\n   * @function\n   */\n  showResults_(results, container) {\n    this.getLayer().clear();\n\n    let resultsTemplateVars = {};\n    if (container === this.resultsRCContainer_) {\n      resultsTemplateVars = this.parseRCResultsForTemplate_(results, false);\n    } else if (container === this.resultsParamsContainer_) {\n      resultsTemplateVars = this.parseParamsResultsForTemplate_(results, false);\n      // this.parseParamsResultsForTemplate_(results, false).then((res) => {\n      //   resultsTemplateVars = res;\n      // });\n    }\n\n    Promise.resolve(resultsTemplateVars).then((resultTemplate) => {\n      this.drawResults(resultTemplate);\n      const html = M.template.compileSync(templateResults, { vars: resultTemplate });\n      container.classList.remove(this.HIDDEN_RESULTS_CLASS);\n      let resultsHtmlElements = container.querySelectorAll('.result');\n      let resultHtml;\n      for (let i = 0, ilen = resultsHtmlElements.length; i < ilen; i += 1) {\n        resultHtml = resultsHtmlElements.item(i);\n        resultHtml.removeEventListener('click', this.resultClick_.bind(this));\n      }\n\n      this.zoomToResults();\n\n      const btnResults = container.querySelector('div.page > div.g-cartografia-flecha-arriba');\n      if (!M.utils.isNullOrEmpty(btnResults)) {\n        btnResults.removeEventListener('click', this.resultsClick_.bind(this));\n      }\n\n      // gets the new results scroll\n      // eslint-disable-next-line no-param-reassign\n      container.innerHTML = html.innerHTML;\n      this.resultsScrollContainer_ = container.querySelector('div#m-catastro-results-scroll');\n      this.resultsScrollContainer_.scrollIntoView(false);\n      // adds new events\n      resultsHtmlElements = container.getElementsByClassName('result');\n      for (let i = 0, ilen = resultsHtmlElements.length; i < ilen; i += 1) {\n        resultHtml = resultsHtmlElements.item(i);\n        resultHtml.addEventListener('click', this.resultClick_.bind(this));\n      }\n      this.fire(M.evt.COMPLETED);\n    });\n  }\n\n  /**\n   * This function parses results from RC search for template\n   *\n   * @private\n   * @function\n   */\n  parseRCResultsForTemplate_(results, append) {\n    const docs = this.parseCPMRCResults(results);\n    if (append === true) {\n      this.rcResults_.unshift(docs);\n    } else {\n      this.rcResults_ = [docs];\n    }\n\n    return {\n      docs: this.rcResults_,\n      total: this.rcResults_.length,\n      partial: false,\n      notResutls: false,\n      query: this.inputRC_.value,\n    };\n  }\n\n  /**\n   * This function parses results from params search for template\n   *\n   * @private\n   * @function\n   */\n  parseParamsResultsForTemplate_(results, append) {\n    const rootElement = results.getElementsByTagName('consulta_dnp')[0];\n    let descripcion = 'N/A';\n    let rcNode;\n    let cnValue = 'UR';\n    const lrcdnpNode = rootElement.getElementsByTagName('lrcdnp');\n\n    if (lrcdnpNode.length > 0) {\n      const rcdnpNode = lrcdnpNode[0].getElementsByTagName('rcdnp')[0];\n      rcNode = rcdnpNode.getElementsByTagName('rc')[0];\n      const dtNode = rcdnpNode.getElementsByTagName('dt')[0];\n      const npNode = dtNode.getElementsByTagName('np')[0].childNodes[0].nodeValue;\n      const nmNode = dtNode.getElementsByTagName('nm')[0].childNodes[0].nodeValue;\n      const locsNode = dtNode.getElementsByTagName('locs')[0];\n      const lorsNode = locsNode.getElementsByTagName('lors')[0];\n      const lorusNode = lorsNode.getElementsByTagName('lorus')[0];\n      const npaNode = lorusNode.getElementsByTagName('npa')[0].childNodes[0].nodeValue;\n      const cpajNode = lorusNode.getElementsByTagName('cpaj')[0].childNodes[0].nodeValue;\n      descripcion = `${npaNode} ${cpajNode}. ${nmNode} (${npNode})`;\n    } else {\n      const bicoNode = rootElement.getElementsByTagName('bico')[0];\n      const biNode = bicoNode.getElementsByTagName('bi')[0];\n      const idbiNode = biNode.getElementsByTagName('idbi')[0];\n      cnValue = idbiNode.getElementsByTagName('cn')[0].childNodes[0].nodeValue;\n      rcNode = idbiNode.getElementsByTagName('rc')[0];\n      descripcion = biNode.getElementsByTagName('ldt')[0].childNodes[0].nodeValue;\n    }\n\n    const pc1Value = rcNode.getElementsByTagName('pc1')[0].childNodes[0].nodeValue;\n    const pc2Value = rcNode.getElementsByTagName('pc2')[0].childNodes[0].nodeValue;\n    const paramsId = this.selectProvincias.value + this.selectMunicipios.value + this.inputPoligono.value + this.inputParcela.value;\n    const searchUrl = M.utils.addParameters(this.CPMRC_url_, {\n      Provincia: '',\n      Municipio: '',\n      SRS: this.facadeMap_.getProjection().code,\n      RC: pc1Value + pc2Value,\n    });\n\n    return M.remote.get(searchUrl).then((response) => {\n      const success = this.acceptOVCSW(response);\n      if (success) {\n        const docsRC = this.parseCPMRCResults(response.xml);\n        const xcen = docsRC.coords[0].xcen;\n        const ycen = docsRC.coords[0].ycen;\n        const srs = docsRC.coords[0].srs;\n        const docs = {\n          attributes: [{\n            key: 'Referencia Catastral',\n            value: pc1Value + pc2Value,\n          }, {\n            key: 'Descripción',\n            value: descripcion,\n          }, {\n            key: 'Tipo',\n            value: cnValue,\n          }],\n          paramsId,\n          rcId: `rc_${pc1Value}${pc2Value}`,\n          coords: [{\n            xcen,\n            ycen,\n            srs,\n          }],\n        };\n        if (append === true) {\n          this.paramsResults_.unshift(docs);\n        } else {\n          this.paramsResults_ = [docs];\n        }\n\n        return {\n          docs: this.paramsResults_,\n          total: this.paramsResults_.length,\n          partial: false,\n          notResutls: false,\n          query: pc1Value + pc2Value,\n        };\n      }\n      return 'Unsuccessful response.';\n    });\n  }\n\n  /**\n   * Result button click handler\n   *\n   * @private\n   * @function\n   */\n  resultClick_(evt) {\n    evt.preventDefault();\n    // hidden results on click for mobile devices\n    if (M.window.WIDTH <= M.config.MOBILE_WIDTH) {\n      // TODO?\n      // evt.target = this.facadeMap_.getContainer()\n      // .querySelector('div.page > div.g-cartografia-flecha-arriba');\n      // this.resultsClick_(evt);\n    }\n    this.facadeMap_.removePopup();\n    const rcId = evt.currentTarget.id;\n    this.resultClick(rcId);\n  }\n\n  /**\n   * Clear button click handler\n   * Clears selects, inputs and result info from panel.\n   *\n   * @private\n   * @function\n   */\n  clearClick_() {\n    this.element_.classList.remove('shown');\n\n    if (!M.utils.isNullOrEmpty(this.inputRC_)) {\n      this.inputRC_.value = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.selectProvincias)) {\n      this.selectProvincias.value = '0';\n    }\n    if (!M.utils.isNullOrEmpty(this.selectMunicipios)) {\n      this.selectMunicipios.value = '0';\n    }\n    if (!M.utils.isNullOrEmpty(this.inputPoligono)) {\n      this.inputPoligono.value = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.inputParcela)) {\n      this.inputParcela.value = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.resultsRCContainer_)) {\n      this.resultsRCContainer_.innerHTML = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.resultsParamsContainer_)) {\n      this.resultsParamsContainer_.innerHTML = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.resultsScrollContainer_)) {\n      this.resultsScrollContainer_.innerHTML = '';\n      this.resultsScrollContainer_ = null;\n    }\n    if (!M.utils.isNullOrEmpty(this.rcResults_)) {\n      this.rcResults_.length = 0;\n    } else {\n      this.rcResults_ = [];\n    }\n    if (!M.utils.isNullOrEmpty(this.paramsResults_)) {\n      this.paramsResults_.length = 0;\n    } else {\n      this.paramsResults_ = [];\n    }\n\n    this.resultsRCContainer_.classList.remove(this.HIDDEN_RESULTS_CLASS);\n    this.resultsParamsContainer_.classList.remove(this.HIDDEN_RESULTS_CLASS);\n    this.clear();\n  }\n\n  /**\n   * Handler for click on results button\n   *\n   * @private\n   * @function\n   */\n  resultsClick_(evt) {\n    this.facadeMap_.areasContainer.getElementsByClassName('m-top m-right')[0].classList.add('top-extra-search');\n    evt.target.classlist.toggle('g-cartografia-flecha-arriba');\n    evt.target.classlist.toggle('g-cartografia-flecha-abajo');\n    this.resultsRCContainer_.classlist.toggle(this.HIDDEN_RESULTS_CLASS);\n    this.resultsParamsContainer_.classlist.toggle(this.HIDDEN_RESULTS_CLASS);\n  }\n\n  /**\n   * Handler for selecting an option on Provincia select\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  onProvinciaSelect(e) {\n    const elt = e.target;\n    const provinceCode = elt.value;\n    if (provinceCode !== '0') {\n      M.remote.get(this.ConsultaMunicipioCodigos_, {\n        CodigoProvincia: provinceCode,\n        CodigoMunicipio: '',\n        CodigoMunicipioIne: '',\n      }).then((res) => {\n        this.loadMunicipiosSelect(res);\n      });\n    } else {\n      this.clearMunicipiosSelect();\n    }\n  }\n\n  /**\n   * Clears options set to Municipios select\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  clearMunicipiosSelect() {\n    const select = this.element_.getElementsByTagName('select')['m-searchParamsMunicipio-select'];\n    while (select.firstChild) {\n      select.removeChild(select.firstChild);\n    }\n    const option = document.createElement('option');\n    option.value = '0';\n    option.innerHTML = 'Seleccione un municipio';\n    select.appendChild(option);\n  }\n\n  /**\n   * Loads and renders options set to Municipios select\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  loadMunicipiosSelect(response) {\n    if ((response.code === 200) && (response.error === false)) {\n      const rootElement = response.xml.getElementsByTagName('consulta_municipiero')[0];\n      const rootMunicipios = rootElement.getElementsByTagName('municipiero')[0];\n      const muniNodes = rootMunicipios.getElementsByTagName('muni');\n      const select = this.element_.getElementsByTagName('select')['m-searchParamsMunicipio-select'];\n      this.clearMunicipiosSelect();\n      for (let i = 0; i < muniNodes.length; i += 1) {\n        const option = document.createElement('option');\n        const locat = muniNodes[i].getElementsByTagName('locat')[0];\n        option.value = locat.getElementsByTagName('cmc')[0].childNodes[0].nodeValue;\n        option.innerHTML = muniNodes[i].getElementsByTagName('nm')[0].childNodes[0].nodeValue;\n        select.appendChild(option);\n      }\n    } else {\n      M.dialog.error('MAPEA: No es posible establecer la conexión con el servidor de Catastro.');\n    }\n  }\n\n  /**\n   * This function draws the results into the specified map\n   *\n   * @public\n   * @function\n   * @param {Array<Object>} results to draw\n   * @api stable\n   */\n  drawResults(results) {\n    let docs = [];\n\n    if (M.utils.isNullOrEmpty(docs)) {\n      docs = results.docs;\n    }\n\n    const features = docs.map((doc) => {\n      const xcenNode = doc.coords[0].xcen;\n      const ycenNode = doc.coords[0].ycen;\n\n      const attributes = {};\n      doc.attributes.forEach((element) => {\n        attributes[element.key] = element.value;\n      });\n      const feature = new M.Feature(doc.rcId, {\n        type: 'Feature',\n        geometry: {\n          type: 'Point',\n          coordinates: [xcenNode, ycenNode],\n        },\n        properties: attributes,\n      });\n\n      return feature;\n    }, this);\n    // TODO: Aplicar estilo a capa Catastro? se puede cambiar desde fuera\n    this.layer_.addFeatures(features);\n  }\n\n  /**\n   * This function zooms the view to the results on layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  zoomToResults() {\n    const bbox = this.layer_.getFeaturesExtent();\n\n    this.facadeMap_.removePopup();\n    this.facadeMap_.setBbox(bbox);\n  }\n\n  /**\n   * This function returns the layer used\n   *\n   * @public\n   * @function\n   * @returns {ol.layer.Vector}\n   * @api stable\n   */\n  getLayer() {\n    return this.layer_;\n  }\n\n  /**\n   * TODO\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  resultClick(rcid) {\n    const feature = this.layer_.getFeatureById(rcid);\n    this.selectedFeatures_ = [feature];\n\n    const featureGeom = feature.getGeometry();\n    const coord = featureGeom.coordinates;\n\n    this.unselectResults();\n    this.selectFeatures([feature], coord, true);\n\n    this.facadeMap_.setCenter(coord);\n    this.facadeMap_.setZoom(15);\n  }\n\n  /**\n   * This function clears the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  clear() {\n    this.facadeMap_.removePopup();\n    this.layer_.clear();\n  }\n\n  /**\n   * This function checks if an object is equals\n   * to this layer\n   * @public\n   * @function\n   * @param {ol.Feature} feature\n   * @api stable\n   */\n  selectFeatures(features, coord, noPanMapIfOutOfView) {\n    // unselects previous features\n    this.unselectResults();\n\n    // sets the style\n    this.selectedFeatures_ = features;\n\n    const featureForTemplate = this.parseFeaturesForTemplate_(features);\n    const htmlAsText = M.template.compileSync(templatePopUp, {\n      jsonp: false,\n      vars: featureForTemplate,\n      parseToHtml: false,\n    });\n    const featureTabOpts = {\n      icon: 'g-cartografia-pin',\n      title: this.POPUP_TITLE,\n      content: htmlAsText,\n    };\n    let popup = this.facadeMap_.getPopup();\n    if (M.utils.isNullOrEmpty(popup)) {\n      popup = new M.Popup({\n        panMapIfOutOfView: !noPanMapIfOutOfView,\n        ani: null,\n      });\n      popup.addTab(featureTabOpts);\n      this.facadeMap_.addPopup(popup, [parseFloat(coord[0]), parseFloat(coord[1])]);\n    } else {\n      popup.addTab(featureTabOpts);\n    }\n    // removes events on destroy\n    popup.on(M.evt.DESTROY, () => {\n      this.unselectResults(true);\n    }, this);\n  }\n\n  /**\n   * This function checks if an object is equals\n   * to this control\n   *\n   * @private\n   * @function\n   */\n  parseFeaturesForTemplate_(features) {\n    const featuresTemplate = {\n      features: [],\n    };\n\n    features.forEach((feature) => {\n      const attributes = [];\n      const properties = feature.getAttributes();\n      Object.keys(properties).forEach((elem, key) => {\n        attributes.push({ elem, value: properties[elem] });\n      });\n      // Old code:\n      // for (const key in properties) {\n      //   attributes.push({ key, value: properties[key] });\n      // }\n      const featureTemplate = {\n        attributes,\n      };\n      featuresTemplate.features.push(featureTemplate);\n    });\n    return featuresTemplate;\n  }\n\n  /**\n   * TODO\n   *\n   * @public\n   * @function\n   * @param {boolean} keepPopup to draw\n   * @api stable\n   */\n  unselectResults(keepPopup) {\n    if (this.selectedFeatures_.length > 0) {\n      this.selectedFeatures_.length = 0;\n      // removes the popup just when event destroy was not fired\n      if (!keepPopup) {\n        this.facadeMap_.removePopup();\n      }\n    }\n  }\n\n  /**\n   * This function is called on the control activation\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  activate() {\n    if (this.activated) {\n      this.deactivate();\n    } else {\n      let someCtlActive = false;\n      const controls = this.facadeMap_.getControls();\n      // TODO: check if this should be: someCtlActive = controls.some(...)\n      controls.some((control) => {\n        if (control.activated === true && !(control instanceof this)) {\n          M.dialog.info(`Desactive el control ${control.name} antes de activar este.`);\n          someCtlActive = true;\n        }\n        return someCtlActive;\n      });\n\n      if (someCtlActive === false) {\n        this.facadeMap_.on(M.evt.CLICK, this.buildUrl_, this);\n        this.activated = true;\n        this.element_.querySelector('#m-catastrogetinfo-button').classList.add('activated');\n        this.element_.querySelector('#m-referencelocatorcatastro-button').classList.remove('activated');\n      } else {\n        this.activated = false;\n      }\n    }\n  }\n\n  /**\n   * This function is called on the control deactivation\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  deactivate() {\n    this.facadeMap_.removePopup();\n    this.facadeMap_.un(M.evt.CLICK, this.buildUrl_, this);\n    this.activated = false;\n    this.element_.querySelector('#m-catastrogetinfo-button').classList.remove('activated');\n  }\n  /**\n   * This function gets activation button\n   *\n   * @public\n   * @function\n   * @param {HTML} html of control\n   * @api stable\n   */\n  getActivationButton(html) {\n    return html.querySelector('.m-referencelocatorcatastro button');\n  }\n\n  /**\n   * This function compares controls\n   *\n   * @public\n   * @function\n   * @param {M.Control} control to compare\n   * @api stable\n   */\n  equals(obj) {\n    let equals = false;\n    if (obj instanceof ReferenceLocatorCatastroControl) {\n      equals = (this.name === obj.name);\n    }\n    return equals;\n  }\n\n  /**\n   * This function destroys this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroy() {\n    this.clear();\n    this.facadeMap_.areasContainer.querySelector('.m-top.m-right').classList.remove('top-extra');\n    this.facadeMap_.getMapImpl().removeControl(this);\n    this.facadeMap_ = null;\n    this.layer_ = null;\n  }\n}\n","/**\n * @module M/plugin/ReferenceLocatorCatastro\n */\nimport 'assets/css/referencelocatorcatastro';\nimport ReferenceLocatorCatastroControl from './referencelocatorcatastrocontrol';\nimport api from '../../api';\n\nexport default class ReferenceLocatorCatastro extends M.Plugin {\n  /**\n   * @classdesc\n   * Main facade plugin object. This class creates a plugin\n   * object which has an implementation Object\n   *\n   * @constructor\n   * @extends {M.Plugin}\n   * @param {Object} impl implementation object\n   * @api stable\n   */\n  constructor(userParameters = {}) {\n    if (M.utils.isNullOrEmpty(userParameters)) {\n      M.exception('No ha especificado ningún parámetro.');\n    }\n    super();\n\n    /**\n     * Facade of the map\n     * @private\n     * @type {M.Map}\n     */\n    this.map_ = null;\n\n    /**\n     * Array of controls\n     * @private\n     * @type {Array<M.Control>}\n     */\n    this.controls_ = [];\n\n    /**\n     * Optional WMS Catastro Layer\n     * @private\n     * @type {M.Layer.WMS}\n     */\n    this.catastroLayer_ = null;\n\n    /**\n     * RCCOOR_url\n     * @private\n     * @type {String}\n     */\n    const defectRCCOOR = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_RCCOOR';\n    this.RCCOOR_url = userParameters.RCCOOR_url != null ? userParameters.RCCOOR_url : defectRCCOOR;\n\n\n    /**\n     * CMC_url\n     * @private\n     * @type {String}\n     */\n    const defectCMC = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejeroCodigos.asmx/ConsultaMunicipioCodigos';\n    this.CMC_url = userParameters.CMC_url != null ? userParameters.CMC_url : defectCMC;\n\n    /**\n     * DNPRC_url\n     * @private\n     * @type {String}\n     */\n    const defectDNPRC = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejeroCodigos.asmx/Consulta_DNPRC_Codigos';\n    this.DNPRC_url = userParameters.DNPRC_url != null ? userParameters.DNPRC_url : defectDNPRC;\n\n    /**\n     * CPMRC_url\n     * @private\n     * @type {String}\n     */\n    const defectCPMRC = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_CPMRC';\n    this.CPMRC_url = userParameters.CPMRC_url != null ? userParameters.CPMRC_url : defectCPMRC;\n\n    /**\n     * DNPPP_url\n     * @private\n     * @type {String}\n     */\n    const defectDNPP = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejeroCodigos.asmx/Consulta_DNPPP_Codigos';\n    this.DNPPP_url = userParameters.DNPPP_url != null ? userParameters.DNPPP_url : defectDNPP;\n\n    /**\n     * catastroWMS\n     * @private\n     * @type {Object}\n     */\n    this.catastroWMS = userParameters.catastroWMS || {};\n\n    /**\n     * Metadata from api.json\n     * @private\n     * @type {Object}\n     */\n    this.metadata_ = api.metadata;\n  }\n\n  /**\n   * This function adds this plugin into the map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map the map to add the plugin\n   * @api stable\n   */\n  addTo(map) {\n    this.config_ = {\n      RCCOOR_url: this.RCCOOR_url,\n      CMC_url: this.CMC_url,\n      DNPRC_url: this.DNPRC_url,\n      CPMRC_url: this.CPMRC_url,\n      DNPPP_url: this.DNPPP_url,\n      catastroWMS: this.catastroWMS,\n    };\n    this.controls_.push(new ReferenceLocatorCatastroControl(this.config_));\n    this.map_ = map;\n    map.areasContainer.querySelector('.m-top.m-right').classList.add('top-extra');\n    this.panel_ = new M.ui.Panel('panelReferenceLocatorCatastro', {\n      className: 'm-catastro',\n      collapsedButtonClass: 'g-catastropanel-button-closed',\n      collapsible: true,\n      position: M.ui.position.TL,\n      tooltip: 'Búsqueda catastral',\n    });\n    this.panel_.on(M.evt.ADDED_TO_MAP, (html) => {\n      M.utils.enableTouchScroll(html);\n    });\n    this.panel_.addControls(this.controls_);\n    map.addPanels(this.panel_);\n\n    // Capa WMS opcional de Catastro\n    if (this.config_.catastroWMS.wms_url && this.config_.catastroWMS.name) {\n      this.catastroLayer_ = new M.layer.WMS({\n        url: this.config_.catastroWMS.wms_url,\n        name: this.config_.catastroWMS.name,\n        legend: 'Catastro',\n        transparent: true,\n        tiled: false,\n      });\n      this.map_.addWMS(this.catastroLayer_);\n    }\n\n    const that = this;\n    this.controls_[0].on(M.evt.ADDED_TO_MAP, () => {\n      that.fire(M.evt.ADDED_TO_MAP);\n    });\n  }\n\n  /**\n   * This function destroys this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroy() {\n    this.map_.removeControls(this.controls_);\n    [this.map_, this.controls_, this.panel_] = [null, null, null];\n  }\n\n  /**\n   * This function returns the controls instanced in this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getControls() {\n    return this.controls_;\n  }\n\n  /**\n   * This functions gets results layer\n   * @public\n   * @function\n   * @api\n   */\n  getResultsLayer() {\n    return this.controls_[0].getLayer();\n  }\n\n  /**\n   * This function returns the controls instanced in this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getWMSCatastroLayer() {\n    return (this.catastroLayer_);\n  }\n\n  /**\n   * @getter\n   * @public\n   */\n  get name() {\n    return 'referencelocatorcatastro';\n  }\n\n  /**\n   * This function gets metadata plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getMetadata() {\n    return this.metadata_;\n  }\n}\n","import M$plugin$ReferenceLocatorCatastro from './/facade/js/referencelocatorcatastro';\nimport M$control$ReferenceLocatorCatastroControl from './/facade/js/referencelocatorcatastrocontrol';\nimport M$impl$control$ReferenceLocatorCatastroControl from './/impl/ol/js/referencelocatorcatastrocontrol';\n\nif (!window.M.plugin) window.M.plugin = {};\nif (!window.M.control) window.M.control = {};\nif (!window.M.impl) window.M.impl = {};\nif (!window.M.impl.control) window.M.impl.control = {};\nwindow.M.plugin.ReferenceLocatorCatastro = M$plugin$ReferenceLocatorCatastro;\nwindow.M.control.ReferenceLocatorCatastroControl = M$control$ReferenceLocatorCatastroControl;\nwindow.M.impl.control.ReferenceLocatorCatastroControl = M$impl$control$ReferenceLocatorCatastroControl;\n"],"sourceRoot":""}