{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/templates/referencelocatorcatastro.html","webpack:///./src/templates/results.html","webpack:///./src/templates/featurepopup.html","webpack:///./src/impl/ol/js/referencelocatorcatastrocontrol.js","webpack:///./src/facade/js/referencelocatorcatastrocontrol.js","webpack:///./src/facade/js/referencelocatorcatastro.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ReferenceLocatorCatastroControl","M","impl","Control","map","html","_get","_getPrototypeOf","this","parameters","_this","referencelocatorcatastrocontrol_classCallCheck","utils","isUndefined","ReferenceLocatorCatastroImplControl","exception","referencelocatorcatastrocontrol_possibleConstructorReturn","referencelocatorcatastrocontrol_getPrototypeOf","options","config_","isNullOrEmpty","NAME","facadeMap_","inputRC_","selectProvincias","selectMunicipios","inputPoligono","inputParcela","ConsultaMunicipioCodigos_","CMC_url","DNPRC_url_","DNPRC_url","CPMRC_url_","CPMRC_url","DNPPP_url_","DNPPP_url","RCCOOR_url_","RCCOOR_url","resultsRCContainer_","resultsParamsContainer_","resultsScrollContainer_","searchingRCResult_","searchingParamsResult_","searchTime_","rcResults_","paramsResults_","scrollIsUp_","draggablePanel","panelMinimized","element_","SEARCHING_CLASS","HIDDEN_RESULTS_CLASS","POPUP_TITLE","layer_","layer","GeoJSON","crs","querySelector","_this2","addLayers","displayInLayerSwitcher","Promise","success","fail","template","compileSync","setStyle","createCatastroPanel","addEvents_","togglePanel","_this3","searchRCContainer","searchParamsContainer","searchRCResults","searchParamsResults","searchRCTab","searchParamsTab","addEventListener","classList","contains","add","remove","onRCSearch","activeSearch","activeInfo","clearResults","onProvinciaSelect","e","onParamsSearch","tooltip","setAttribute","icon","order","parentNode","concat","deactivate","activate","element","on","evt","COMPLETED","clearClick_","_this4","srs","getProjection","code","remote","SRS","Coordenada_X","coord","Coordenada_Y","then","res","showInfoFromURL_","jsonp","response","coordinates","_this5","error","infos","info","text","formatedInfo","formatInfo_","push","tab","title","content","join","popup","getPopup","Popup","addTab","addPopup","getCoordinate","hasExternalContent","getTabs","forEach","removeTab","removePopup","dialog","ldtNode","valuePopup","codProv","codMun","rootElement","DOMParser","parseFromString","getElementsByTagName","childNodes","nodeValue","coordNode","pc1Node","pc2Node","substring","link","beautifyAttribute","panelContent","style","display","preventDefault","type","keyCode","inputRC","substr","searchUrl","addParameters","Provincia","Municipio","RC","search_","showResults_","CodigoProvincia","CodigoMunicipio","CodigoMunicipioINE","Poligono","Parcela","container","searchingResult","processor","_this6","appendChild","acceptOVCSW","xml","errorCtlNode","cuerr","undefined","errorDescTxt","err","xmlResults","pcNode","geoNode","xcenNode","ycenNode","srsNode","attributes","rcId","coords","xcen","ycen","results","_this7","getLayer","clear","resultsTemplateVars","parseRCResultsForTemplate_","parseParamsResultsForTemplate_","resolve","resultTemplate","drawResults","templateResults","vars","resultsHtmlElements","querySelectorAll","ilen","length","item","removeEventListener","resultClick_","zoomToResults","btnResults","resultsClick_","innerHTML","scrollIntoView","getElementsByClassName","fire","append","docs","parseCPMRCResults","unshift","total","partial","notResutls","query","rcNode","_this8","descripcion","cnValue","lrcdnpNode","rcdnpNode","dtNode","npNode","nmNode","lorusNode","npaNode","cpajNode","biNode","idbiNode","pc1Value","pc2Value","paramsId","docsRC","window","WIDTH","config","MOBILE_WIDTH","currentTarget","id","resultClick","areasContainer","target","classlist","toggle","_this9","provinceCode","CodigoMunicipioIne","loadMunicipiosSelect","clearMunicipiosSelect","select","firstChild","removeChild","option","document","createElement","muniNodes","locat","features","doc","Feature","geometry","properties","addFeatures","bbox","getFeaturesExtent","setBbox","rcid","feature","getFeatureById","selectedFeatures_","getGeometry","unselectResults","selectFeatures","setCenter","setZoom","noPanMapIfOutOfView","_this10","featureForTemplate","parseFeaturesForTemplate_","htmlAsText","templatePopUp","parseToHtml","featureTabOpts","panMapIfOutOfView","ani","parseFloat","DESTROY","featuresTemplate","getAttributes","keys","elem","featureTemplate","keepPopup","_this11","activated","someCtlActive","getControls","some","control","CLICK","buildUrl_","un","obj","equals","getMapImpl","removeControl","ReferenceLocatorCatastro","userParameters","arguments","referencelocatorcatastro_classCallCheck","referencelocatorcatastro_possibleConstructorReturn","referencelocatorcatastro_getPrototypeOf","map_","controls_","catastroLayer_","catastroWMS","metadata_","api","metadata","Plugin","panel_","ui","Panel","className","collapsedButtonClass","collapsible","position","TL","ADDED_TO_MAP","enableTouchScroll","addControls","addPanels","wms_url","WMS","url","legend","transparent","tiled","addWMS","that","removeControls","_ref","plugin","M$plugin$ReferenceLocatorCatastro","M$control$ReferenceLocatorCatastroControl","M$impl$control$ReferenceLocatorCatastroControl"],"mappings":"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA,mBClFAhC,EAAAD,QAAA,m3JCAAC,EAAAD,QAAA,oqCCAAC,EAAAD,QAAA,8zGCGqBkC,gaAAwCC,EAAEC,KAAKC,6CAU5DC,EAAKC,GACTC,EAAAC,EAAAP,EAAAJ,WAAA,QAAAY,MAAArC,KAAAqC,KAAYJ,EAAKC,m4BCLAL,cAUnB,SAAAA,EAAYS,GAAY,IAAAC,+FAAAC,CAAAH,KAAAR,GAClBC,EAAEW,MAAMC,YAAYC,IACtBb,EAAEc,UAAU,qFAGd,IAAMb,EAAO,IAAIY,EALK,OAMtBJ,EAAAM,EAAAR,KAAAS,EAAAjB,GAAA7B,KAAAqC,KAAMN,EAAM,6BAERO,GACFC,EAAKQ,QAAWT,GAAc,GAC9BC,EAAKS,QAAWV,GAAc,IAE9BR,EAAEc,UAAU,8DAGVd,EAAEW,MAAMC,YAAYH,EAAKQ,QAAQ3C,OAAS0B,EAAEW,MAAMQ,cAAcV,EAAKQ,QAAQ3C,SAC/EmC,EAAKQ,QAAQ3C,KAAOmC,EAAKW,MAAQ,4BAGnCX,EAAKY,WAAa,KAOlBZ,EAAKa,SAAW,KAOhBb,EAAKc,iBAAmB,KAOxBd,EAAKe,iBAAmB,KAOxBf,EAAKgB,cAAgB,KAOrBhB,EAAKiB,aAAe,KAOpBjB,EAAKkB,0BAA4BlB,EAAKS,QAAQU,QAO9CnB,EAAKoB,WAAapB,EAAKS,QAAQY,UAO/BrB,EAAKsB,WAAatB,EAAKS,QAAQc,UAO/BvB,EAAKwB,WAAaxB,EAAKS,QAAQgB,UAO/BzB,EAAK0B,YAAc1B,EAAKS,QAAQkB,WAOhC3B,EAAK4B,oBAAsB,KAO3B5B,EAAK6B,wBAA0B,KAO/B7B,EAAK8B,wBAA0B,KAO/B9B,EAAK+B,mBAAqB,KAO1B/B,EAAKgC,uBAAyB,KAO9BhC,EAAKiC,YAAc,EAOnBjC,EAAKkC,WAAa,GAOlBlC,EAAKmC,eAAiB,GAOtBnC,EAAKoC,aAAc,EAOnBpC,EAAKqC,eAAiB,KAOtBrC,EAAKsC,gBAAiB,EAOtBtC,EAAKuC,SAAW,KAShBvC,EAAKwC,gBAAkB,cASvBxC,EAAKyC,qBAAuB,SAS5BzC,EAAK0C,YAAc,wBAOnB1C,EAAK2C,OAAS,IAAIpD,EAAEqD,MAAMC,QAAQ,CAAEhF,KAAM,wBAAyBiF,IAAK,UA/MlD9C,wPAVmCT,EAAEE,kDAoOlDE,GACTG,KAAKyC,SAAW5C,EAEhBG,KAAK8B,oBAAsB9B,KAAKyC,SAASQ,cAAc,0BACvDjD,KAAKiC,mBAAqBjC,KAAKyC,SAASQ,cAAc,4DACtDjD,KAAK+B,wBAA0B/B,KAAKyC,SAASQ,cAAc,8BAC3DjD,KAAKkC,uBAAyBlC,KAAKyC,SAASQ,cAAc,uGAWjDrD,GAAK,IAAAsD,EAAAlD,KAKd,OAJAA,KAAKc,WAAalB,EAClBI,KAAKc,WAAWqC,UAAUnD,KAAK6C,QAC/B7C,KAAK6C,OAAOO,wBAAyB,EAE9B,IAAIC,QAAQ,SAACC,EAASC,GAC3B,IAAM1D,EAAOJ,EAAE+D,SAASC,YAAYD,KACpCN,EAAKQ,SAAS7D,EAAMqD,EAAKxC,SACzBwC,EAAKT,SAAW5C,EAChBqD,EAAKS,sBACLT,EAAKU,WAAWV,EAAKT,UACrBS,EAAKW,cACLP,EAAQzD,mDAWU,IAAAiE,EAAA9D,KACd+D,EAAoB/D,KAAKyC,SAASQ,cAAc,4BAChDe,EAAwBhE,KAAKyC,SAASQ,cAAc,gCACpDgB,EAAkBjE,KAAKyC,SAASQ,cAAc,0BAC9CiB,EAAsBlE,KAAKyC,SAASQ,cAAc,8BAClDkB,EAAcnE,KAAKyC,SAASQ,cAAc,4DAC1CmB,EAAkBpE,KAAKyC,SAASQ,cAAc,4DAEpDkB,EAAYE,iBAAiB,QAAS,WAC/BF,EAAYG,UAAUC,SAAS,eAClCJ,EAAYG,UAAUE,IAAI,aAC1BJ,EAAgBE,UAAUG,OAAO,aACjCV,EAAkBO,UAAUE,IAAI,QAChCP,EAAgBK,UAAUE,IAAI,QAC9BN,EAAoBI,UAAUG,OAAO,QACrCT,EAAsBM,UAAUG,OAAO,WAI3CL,EAAgBC,iBAAiB,QAAS,WACnCD,EAAgBE,UAAUC,SAAS,eACtCH,EAAgBE,UAAUE,IAAI,aAC9BL,EAAYG,UAAUG,OAAO,aAC7BV,EAAkBO,UAAUG,OAAO,QACnCR,EAAgBK,UAAUG,OAAO,QACjCP,EAAoBI,UAAUE,IAAI,QAClCR,EAAsBM,UAAUE,IAAI,WAIxCxE,KAAKe,SAAWf,KAAKyC,SAASQ,cAAc,qBAC5CjD,KAAKe,SAASsD,iBAAiB,QAASrE,KAAK0E,WAAW1F,KAAKgB,OAEvCA,KAAKyC,SAASQ,cAAc,sCACpCoB,iBAAiB,QAASrE,KAAK2E,aAAa3F,KAAKgB,OAEzCA,KAAKyC,SAASQ,cAAc,6BACpCoB,iBAAiB,QAASrE,KAAK4E,WAAW5F,KAAKgB,OAEzCA,KAAKyC,SAASQ,cAAc,2BACpCoB,iBAAiB,QAASrE,KAAK6E,aAAa7F,KAAKgB,OAE7DA,KAAKgB,iBAAmBhB,KAAKyC,SAASQ,cAAc,mCACpDjD,KAAKgB,iBAAiBqD,iBAAiB,SAAUrE,KAAK8E,kBAAkB9F,KAAKgB,OAE7EA,KAAKiB,iBAAmBjB,KAAKyC,SAASQ,cAAc,mCACpDjD,KAAKkB,cAAgBlB,KAAKyC,SAASQ,cAAc,iCACjDjD,KAAKmB,aAAenB,KAAKyC,SAASQ,cAAc,gCAEzBjD,KAAKyC,SAASQ,cAAc,sBACpCoB,iBAAiB,QAASrE,KAAK0E,WAAW1F,KAAKgB,OAEnCA,KAAKyC,SAASQ,cAAc,0BACpCoB,iBAAiB,QAAS,SAAAU,GAAC,OAAIjB,EAAKkB,eAAeD,KAEhD/E,KAAKyC,SAASQ,cAAc,qBACpCoB,iBAAiB,QAASrE,KAAK6E,aAAa7F,KAAKgB,OAErCA,KAAKyC,SAASQ,cAAc,yBACpCoB,iBAAiB,QAASrE,KAAK6E,aAAa7F,KAAKgB,wCAU5DH,EAAMa,GACRjB,EAAEW,MAAMC,YAAYK,EAAQuE,UAAaxF,EAAEW,MAAMQ,cAAcF,EAAQuE,UAC1EpF,EAAKoD,cAAc,UAAUiC,aAAa,QAASxE,EAAQuE,SAExDxF,EAAEW,MAAMC,YAAYK,EAAQyE,OAAU1F,EAAEW,MAAMQ,cAAcF,EAAQyE,OACvEtF,EAAKoD,cAAc,UAAUiC,aAAa,QAASxE,EAAQyE,MAExD1F,EAAEW,MAAMC,YAAYK,EAAQ0E,QAAW3F,EAAEW,MAAMQ,cAAcF,EAAQ0E,QACxEvF,EAAKoD,cAAc,UAAUoC,WAAWH,aAAa,QAArD,UAAAI,OAAwE5E,EAAQ0E,+CAYlFpF,KAAKuF,aACLvF,KAAK6D,cACL,IAAMS,EAAYtE,KAAKyC,SAASQ,cAAc,sCAAsCqB,UAChFA,EAAUC,SAAS,aACrBD,EAAUG,OAAO,aAEjBH,EAAUE,IAAI,mDAYY,IAAxBxE,KAAKwC,gBACPxC,KAAK6D,cAEP7D,KAAKwF,kDAYQC,GACbzF,KAAK0F,GAAGjG,EAAEkG,IAAIC,UAAW,WACvBH,EAAQnB,UAAUE,IAAI,WAGFiB,EAAQxC,cAAc,qBAC9BoB,iBAAiB,QAASrE,KAAK6E,aAAa7F,KAAKgB,OAErCyF,EAAQxC,cAAc,yBAC9BoB,iBAAiB,QAASrE,KAAK6E,aAAa7F,KAAKgB,OAE/CyF,EAAQxC,cAAc,0BAC9BoB,iBAAiB,QAASrE,KAAK6E,aAAa7F,KAAKgB,8CAW7DA,KAAK6F,gDAUGF,GAAK,IAAAG,EAAA9F,KAKP+F,EAAM/F,KAAKc,WAAWkF,gBAAgBC,KAE5CxG,EAAEyG,OAAO7H,IAAI2B,KAAK4B,YAAa,CAC7BuE,IAAKJ,EACLK,aAAcT,EAAIU,MAAM,GACxBC,aAAcX,EAAIU,MAAM,KACvBE,KAAK,SAACC,GACPV,EAAKW,iBAAiBD,EAAKb,EAAIU,QAXjB,CACdK,OAAO,6CAsBMC,EAAUC,GAAa,IAAAC,EAAA7G,KAKtC,GAAuB,MAAlB2G,EAASV,OAAqC,IAAnBU,EAASG,MAAkB,CACzD,IAAMC,EAAQ,GACRC,EAAOL,EAASM,KAChBC,EAAelH,KAAKmH,YAAYH,GACtCD,EAAMK,KAAKF,GAEX,IAAMG,EAAM,CACVlC,KAAM,oBACNmC,MAAOtH,KAAK4C,YACZ2E,QAASR,EAAMS,KAAK,KAGlBC,EAAQzH,KAAKc,WAAW4G,WAE5B,GAAIjI,EAAEW,MAAMQ,cAAc6G,IACxBA,EAAQ,IAAIhI,EAAEkI,OACRC,OAAOP,GACbrH,KAAKc,WAAW+G,SAASJ,EAAOb,QAC3B,GAAIa,EAAMK,gBAAgB,KAAOlB,EAAY,IAAMa,EAAMK,gBAAgB,KAAOlB,EAAY,GAAI,CAGrG,IAAImB,GAAqB,EACzBN,EAAMO,UAAUC,QAAQ,SAACvJ,GACnBA,EAAE4I,QAAUT,EAAKjE,YACnBmF,GAAqB,EAErBN,EAAMS,UAAUxJ,KAGhBqJ,EACFN,EAAMG,OAAOP,KAGbI,EAAQ,IAAIhI,EAAEkI,OACRC,OAAOP,GACbrH,KAAKc,WAAW+G,SAASJ,EAAOb,SAGlCa,EAAQ,IAAIhI,EAAEkI,OACRC,OAAOP,GACbrH,KAAKc,WAAW+G,SAASJ,EAAOb,QAGlC5G,KAAKc,WAAWqH,cAChB1I,EAAE2I,OAAOtB,MAAM,gHAYPE,GACV,IAEIqB,EACAC,EACAC,EACAC,EAEEC,GAPS,IAAIC,WACGC,gBAAgB3B,EAAM,YAMjB4B,qBAAqB,wBAAwB,GAGxE,GAAqB,MAFDH,EAAYG,qBAAqB,WAAW,GAC/BA,qBAAqB,SAAS,GAAGC,WAAW,GAAGC,UACtD,CAIxBR,EAHkBG,EAAYG,qBAAqB,QAAQ,GAC/BA,qBAAqB,OAAO,GACzBA,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,cAEvE,CACL,IACMC,EADkBN,EAAYG,qBAAqB,eAAe,GACtCA,qBAAqB,SAAS,GAE1DI,EADSD,EAAUH,qBAAqB,MAAM,GAC7BA,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAC9DG,EAAUF,EAAUH,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAGvEP,EAAUS,EAAQE,UAAU,EAAG,GAC/BV,EAASQ,EAAQE,UAAU,EAAG,GAE9Bb,EAAUU,EAAUH,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UACjER,EAAaU,EAAUC,EAIzB,IAAME,EAAI,iFAAA7D,OAAoFgD,EAApF,6EAAAhD,OAA0KgD,EAA1K,gBAAAhD,OAAmMiD,EAAnM,SAAAjD,OAAkNkD,GAa5N,MAXkB,GAAAlD,OAAM7F,EAAEW,MAAMgJ,kBAAkB,yBAAhC,6JAAA9D,OAKO7F,EAAEW,MAAMgJ,kBAAkB,wBALjC,kDAAA9D,OAMP6D,EANO,sBAAA7D,OAMkBgD,EANlB,+CAAAhD,OAOO7F,EAAEW,MAAMgJ,kBAAkB,eAPjC,qCAAA9D,OAQE+C,EARF,gFAsBlB,IAAMgB,EAAerJ,KAAKyC,SAASQ,cAAc,+CACrB,IAAxBjD,KAAKwC,gBACPxC,KAAKwC,gBAAiB,EACtB6G,EAAaC,MAAMC,QAAU,SAE7BvJ,KAAKwC,gBAAiB,EACtB6G,EAAaC,MAAMC,QAAU,6CAWtB5D,GAET,GADAA,EAAI6D,iBACc,UAAb7D,EAAI8D,MAAsC,KAAhB9D,EAAI+D,QAAiB,CAClD,IAAIC,EAAU3J,KAAKe,UAAYf,KAAKe,SAAStC,MAC7C,GAAIgB,EAAEW,MAAMQ,cAAc+I,GACxBlK,EAAE2I,OAAOpB,KAAK,gDACT,CACL2C,EAAUA,EAAQC,OAAO,EAAG,IAC5B,IAAMC,EAAYpK,EAAEW,MAAM0J,cAAc9J,KAAKwB,WAAY,CACvDuI,UAAW,GACXC,UAAW,GACX7D,IAAKnG,KAAKc,WAAWkF,gBAAgBC,KACrCgE,GAAIN,IAEN3J,KAAKkK,QAAQL,EAAW7J,KAAK8B,oBAAqB9B,KAAKiC,mBAAoBjC,KAAKmK,uDAYvExE,GAGb,GAFAA,EAAI6D,iBAEc,UAAb7D,EAAI8D,MAAsC,KAAhB9D,EAAI+D,QAAiB,CAClD,GAAIjK,EAAEW,MAAMQ,cAAcZ,KAAKgB,iBAAiBvC,QAA0C,MAAhCuB,KAAKgB,iBAAiBvC,MAE9E,YADAgB,EAAE2I,OAAOpB,KAAK,mCAGhB,GAAIvH,EAAEW,MAAMQ,cAAcZ,KAAKiB,iBAAiBxC,QAA0C,MAAhCuB,KAAKiB,iBAAiBxC,MAE9E,YADAgB,EAAE2I,OAAOpB,KAAK,iCAGhB,GAAIvH,EAAEW,MAAMQ,cAAcZ,KAAKkB,cAAczC,OAE3C,YADAgB,EAAE2I,OAAOpB,KAAK,gCAGhB,GAAIvH,EAAEW,MAAMQ,cAAcZ,KAAKmB,aAAa1C,OAE1C,YADAgB,EAAE2I,OAAOpB,KAAK,gCAIhB,IAAM6C,EAAYpK,EAAEW,MAAM0J,cAAc9J,KAAK0B,WAAY,CACvD0I,gBAAiBpK,KAAKgB,iBAAiBvC,MACvC4L,gBAAiBrK,KAAKiB,iBAAiBxC,MACvC6L,mBAAoB,GACpBC,SAAUvK,KAAKkB,cAAczC,MAC7B+L,QAASxK,KAAKmB,aAAa1C,QAE7BuB,KAAKkK,QAAQL,EAAW7J,KAAK+B,wBAAyB/B,KAAKkC,uBAAwBlC,KAAKmK,+CAUpFN,EAAWY,EAAWC,EAAiBC,GAAW,IAAAC,EAAA5K,KACxDyK,EAAUI,YAAYH,GACtB1K,KAAKyC,SAAS6B,UAAUE,IAAIxE,KAAK0C,iBAEjCjD,EAAEyG,OAAO7H,IAAIwL,GAAWtD,KAAK,SAACI,GACZiE,EAAKE,YAAYnE,IAE/BgE,EAAUhN,KAAKiN,EAAMjE,EAASoE,IAAKN,GAErCG,EAAKnI,SAAS6B,UAAUG,OAAOmG,EAAKlI,uDAU5BiE,GACV,IAAIrD,GAAU,EACd,IACE,GAAuB,MAAlBqD,EAASV,OAAqC,IAAnBU,EAASG,MAAkB,CACzD,IACM2B,EADU9B,EAASoE,IACGlC,WAAW,GAEjCmC,EADcvC,EAAYG,qBAAqB,WAAW,GAC/BA,qBAAqB,SAAS,GAC3DqC,EAAQ,IAIZ,QAHqBC,IAAjBF,IACFC,EAAQD,EAAanC,WAAW,GAAGC,WAEvB,MAAVmC,EAAe,CACjB,IAEME,EAFY1C,EAAYG,qBAAqB,QAAQ,GAC/BA,qBAAqB,OAAO,GACzBA,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAC5E9I,KAAKyC,SAAS6B,UAAUG,OAAOzE,KAAK0C,iBACpCY,GAAU,EACV7D,EAAE2I,OAAOpB,KAAKmE,SAGhB7H,GAAU,EACV7D,EAAE2I,OAAOtB,MAAM,4EAEjB,MAAOsE,GACP9H,GAAU,EACV7D,EAAEc,UAAF,sCAAA+E,OAAkD8F,EAAlD,MAEF,OAAO9H,4CASS+H,GAChB,IAEMtC,EAFcsC,EAAWzC,qBAAqB,wBAAwB,GACxCA,qBAAqB,eAAe,GACtCA,qBAAqB,SAAS,GAE1D0C,EAASvC,EAAUH,qBAAqB,MAAM,GAC9CI,EAAUsC,EAAO1C,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAC9DG,EAAUqC,EAAO1C,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAE9DyC,EAAUxC,EAAUH,qBAAqB,OAAO,GAChD4C,EAAWD,EAAQ3C,qBAAqB,QAAQ,GAAGC,WAAW,GAAGC,UACjE2C,EAAWF,EAAQ3C,qBAAqB,QAAQ,GAAGC,WAAW,GAAGC,UACjE4C,EAAUH,EAAQ3C,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAIrE,MAAO,CACL6C,WAAY,CAAC,CACX5M,IAAK,uBACLN,MAAOuK,EAAUC,GAChB,CACDlK,IAAK,cACLN,MARYsK,EAAUH,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,YAUrE8C,KAAI,MAAAtG,OAAQ0D,GAAR1D,OAAkB2D,GACtB4C,OAAQ,CAAC,CACPC,KAAMN,EACNO,KAAMN,EACN1F,IAAK2F,0CAYEM,EAASvB,GAAW,IAAAwB,EAAAjM,KAC/BA,KAAKkM,WAAWC,QAEhB,IAAIC,EAAsB,GACtB3B,IAAczK,KAAK8B,oBACrBsK,EAAsBpM,KAAKqM,2BAA2BL,GAAS,GACtDvB,IAAczK,KAAK+B,0BAC5BqK,EAAsBpM,KAAKsM,+BAA+BN,GAAS,IAMrE3I,QAAQkJ,QAAQH,GAAqB7F,KAAK,SAACiG,GACzCP,EAAKQ,YAAYD,GACjB,IAAM3M,EAAOJ,EAAE+D,SAASC,YAAYiJ,IAAiB,CAAEC,KAAMH,IAC7D/B,EAAUnG,UAAUG,OAAOwH,EAAKtJ,sBAGhC,IAFA,IAAIiK,EAAsBnC,EAAUoC,iBAAiB,WAE5CrP,EAAI,EAAGsP,EAAOF,EAAoBG,OAAQvP,EAAIsP,EAAMtP,GAAK,EACnDoP,EAAoBI,KAAKxP,GAC3ByP,oBAAoB,QAAShB,EAAKiB,aAAalO,KAAKiN,IAGjEA,EAAKkB,gBAEL,IAAMC,EAAa3C,EAAUxH,cAAc,8CACtCxD,EAAEW,MAAMQ,cAAcwM,IACzBA,EAAWH,oBAAoB,QAAShB,EAAKoB,cAAcrO,KAAKiN,IAKlExB,EAAU6C,UAAYzN,EAAKyN,UAC3BrB,EAAKjK,wBAA0ByI,EAAUxH,cAAc,iCACvDgJ,EAAKjK,wBAAwBuL,gBAAe,GAG5C,IAAK,IAAI/P,EAAI,EAAGsP,GADhBF,EAAsBnC,EAAU+C,uBAAuB,WACZT,OAAQvP,EAAIsP,EAAMtP,GAAK,EACnDoP,EAAoBI,KAAKxP,GAC3B6G,iBAAiB,QAAS4H,EAAKiB,aAAalO,KAAKiN,IAE9DA,EAAKwB,KAAKhO,EAAEkG,IAAIC,gEAUOoG,EAAS0B,GAClC,IAAMC,EAAO3N,KAAK4N,kBAAkB5B,GAOpC,OANe,IAAX0B,EACF1N,KAAKoC,WAAWyL,QAAQF,GAExB3N,KAAKoC,WAAa,CAACuL,GAGd,CACLA,KAAM3N,KAAKoC,WACX0L,MAAO9N,KAAKoC,WAAW2K,OACvBgB,SAAS,EACTC,YAAY,EACZC,MAAOjO,KAAKe,SAAStC,8DAUMuN,EAAS0B,GAAQ,IAG1CQ,EAH0CC,EAAAnO,KACxCyI,EAAcuD,EAAQpD,qBAAqB,gBAAgB,GAC7DwF,EAAc,MAEdC,EAAU,KACRC,EAAa7F,EAAYG,qBAAqB,UAEpD,GAAI0F,EAAWvB,OAAS,EAAG,CACzB,IAAMwB,EAAYD,EAAW,GAAG1F,qBAAqB,SAAS,GAC9DsF,EAASK,EAAU3F,qBAAqB,MAAM,GAC9C,IAAM4F,EAASD,EAAU3F,qBAAqB,MAAM,GAC9C6F,EAASD,EAAO5F,qBAAqB,MAAM,GAAGC,WAAW,GAAGC,UAC5D4F,EAASF,EAAO5F,qBAAqB,MAAM,GAAGC,WAAW,GAAGC,UAG5D6F,EAFWH,EAAO5F,qBAAqB,QAAQ,GAC3BA,qBAAqB,QAAQ,GAC5BA,qBAAqB,SAAS,GACnDgG,EAAUD,EAAU/F,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UACjE+F,EAAWF,EAAU/F,qBAAqB,QAAQ,GAAGC,WAAW,GAAGC,UACzEsF,EAAW,GAAA9I,OAAMsJ,EAAN,KAAAtJ,OAAiBuJ,EAAjB,MAAAvJ,OAA8BoJ,EAA9B,MAAApJ,OAAyCmJ,EAAzC,SACN,CACL,IACMK,EADWrG,EAAYG,qBAAqB,QAAQ,GAClCA,qBAAqB,MAAM,GAC7CmG,EAAWD,EAAOlG,qBAAqB,QAAQ,GACrDyF,EAAUU,EAASnG,qBAAqB,MAAM,GAAGC,WAAW,GAAGC,UAC/DoF,EAASa,EAASnG,qBAAqB,MAAM,GAC7CwF,EAAcU,EAAOlG,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAGpE,IAAMkG,EAAWd,EAAOtF,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAC/DmG,EAAWf,EAAOtF,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAC/DoG,EAAWlP,KAAKgB,iBAAiBvC,MAAQuB,KAAKiB,iBAAiBxC,MAAQuB,KAAKkB,cAAczC,MAAQuB,KAAKmB,aAAa1C,MACpHoL,EAAYpK,EAAEW,MAAM0J,cAAc9J,KAAKwB,WAAY,CACvDuI,UAAW,GACXC,UAAW,GACX7D,IAAKnG,KAAKc,WAAWkF,gBAAgBC,KACrCgE,GAAI+E,EAAWC,IAGjB,OAAOxP,EAAEyG,OAAO7H,IAAIwL,GAAWtD,KAAK,SAACI,GAEnC,GADgBwH,EAAKrD,YAAYnE,GACpB,CACX,IAAMwI,EAAShB,EAAKP,kBAAkBjH,EAASoE,KACzCe,EAAOqD,EAAOtD,OAAO,GAAGC,KACxBC,EAAOoD,EAAOtD,OAAO,GAAGE,KACxBhG,EAAMoJ,EAAOtD,OAAO,GAAG9F,IACvB4H,EAAO,CACXhC,WAAY,CAAC,CACX5M,IAAK,uBACLN,MAAOuQ,EAAWC,GACjB,CACDlQ,IAAK,cACLN,MAAO2P,GACN,CACDrP,IAAK,OACLN,MAAO4P,IAETa,WACAtD,KAAI,MAAAtG,OAAQ0J,GAAR1J,OAAmB2J,GACvBpD,OAAQ,CAAC,CACPC,OACAC,OACAhG,SASJ,OANe,IAAX2H,EACFS,EAAK9L,eAAewL,QAAQF,GAE5BQ,EAAK9L,eAAiB,CAACsL,GAGlB,CACLA,KAAMQ,EAAK9L,eACXyL,MAAOK,EAAK9L,eAAe0K,OAC3BgB,SAAS,EACTC,YAAY,EACZC,MAAOe,EAAWC,GAGtB,MAAO,gEAUEtJ,GACXA,EAAI6D,iBAEA/J,EAAE2P,OAAOC,MAAS5P,EAAE6P,OAAOC,aAM/BvP,KAAKc,WAAWqH,cAChB,IAAMyD,EAAOjG,EAAI6J,cAAcC,GAC/BzP,KAAK0P,YAAY9D,yCAWjB5L,KAAKyC,SAAS6B,UAAUG,OAAO,SAE1BhF,EAAEW,MAAMQ,cAAcZ,KAAKe,YAC9Bf,KAAKe,SAAStC,MAAQ,IAEnBgB,EAAEW,MAAMQ,cAAcZ,KAAKgB,oBAC9BhB,KAAKgB,iBAAiBvC,MAAQ,KAE3BgB,EAAEW,MAAMQ,cAAcZ,KAAKiB,oBAC9BjB,KAAKiB,iBAAiBxC,MAAQ,KAE3BgB,EAAEW,MAAMQ,cAAcZ,KAAKkB,iBAC9BlB,KAAKkB,cAAczC,MAAQ,IAExBgB,EAAEW,MAAMQ,cAAcZ,KAAKmB,gBAC9BnB,KAAKmB,aAAa1C,MAAQ,IAEvBgB,EAAEW,MAAMQ,cAAcZ,KAAK8B,uBAC9B9B,KAAK8B,oBAAoBwL,UAAY,IAElC7N,EAAEW,MAAMQ,cAAcZ,KAAK+B,2BAC9B/B,KAAK+B,wBAAwBuL,UAAY,IAEtC7N,EAAEW,MAAMQ,cAAcZ,KAAKgC,2BAC9BhC,KAAKgC,wBAAwBsL,UAAY,GACzCtN,KAAKgC,wBAA0B,MAE5BvC,EAAEW,MAAMQ,cAAcZ,KAAKoC,YAG9BpC,KAAKoC,WAAa,GAFlBpC,KAAKoC,WAAW2K,OAAS,EAItBtN,EAAEW,MAAMQ,cAAcZ,KAAKqC,gBAG9BrC,KAAKqC,eAAiB,GAFtBrC,KAAKqC,eAAe0K,OAAS,EAK/B/M,KAAK8B,oBAAoBwC,UAAUG,OAAOzE,KAAK2C,sBAC/C3C,KAAK+B,wBAAwBuC,UAAUG,OAAOzE,KAAK2C,sBACnD3C,KAAKmM,8CASOxG,GACZ3F,KAAKc,WAAW6O,eAAenC,uBAAuB,iBAAiB,GAAGlJ,UAAUE,IAAI,oBACxFmB,EAAIiK,OAAOC,UAAUC,OAAO,+BAC5BnK,EAAIiK,OAAOC,UAAUC,OAAO,8BAC5B9P,KAAK8B,oBAAoB+N,UAAUC,OAAO9P,KAAK2C,sBAC/C3C,KAAK+B,wBAAwB8N,UAAUC,OAAO9P,KAAK2C,gEAUnCoC,GAAG,IAAAgL,EAAA/P,KAEbgQ,EADMjL,EAAE6K,OACWnR,MACJ,MAAjBuR,EACFvQ,EAAEyG,OAAO7H,IAAI2B,KAAKoB,0BAA2B,CAC3CgJ,gBAAiB4F,EACjB3F,gBAAiB,GACjB4F,mBAAoB,KACnB1J,KAAK,SAACC,GACPuJ,EAAKG,qBAAqB1J,KAG5BxG,KAAKmQ,wEAaP,IADA,IAAMC,EAASpQ,KAAKyC,SAASmG,qBAAqB,UAAU,kCACrDwH,EAAOC,YACZD,EAAOE,YAAYF,EAAOC,YAE5B,IAAME,EAASC,SAASC,cAAc,UACtCF,EAAO9R,MAAQ,IACf8R,EAAOjD,UAAY,0BACnB8C,EAAOvF,YAAY0F,gDAUA5J,GACnB,GAAuB,MAAlBA,EAASV,OAAqC,IAAnBU,EAASG,MAAkB,CACzD,IAEM4J,EAFc/J,EAASoE,IAAInC,qBAAqB,wBAAwB,GAC3CA,qBAAqB,eAAe,GACtCA,qBAAqB,QAChDwH,EAASpQ,KAAKyC,SAASmG,qBAAqB,UAAU,kCAC5D5I,KAAKmQ,wBACL,IAAK,IAAI3S,EAAI,EAAGA,EAAIkT,EAAU3D,OAAQvP,GAAK,EAAG,CAC5C,IAAM+S,EAASC,SAASC,cAAc,UAChCE,EAAQD,EAAUlT,GAAGoL,qBAAqB,SAAS,GACzD2H,EAAO9R,MAAQkS,EAAM/H,qBAAqB,OAAO,GAAGC,WAAW,GAAGC,UAClEyH,EAAOjD,UAAYoD,EAAUlT,GAAGoL,qBAAqB,MAAM,GAAGC,WAAW,GAAGC,UAC5EsH,EAAOvF,YAAY0F,SAGrB9Q,EAAE2I,OAAOtB,MAAM,gHAYPkF,GACV,IAAI2B,EAAO,GAEPlO,EAAEW,MAAMQ,cAAc+M,KACxBA,EAAO3B,EAAQ2B,MAGjB,IAAMiD,EAAWjD,EAAK/N,IAAI,SAACiR,GACzB,IAAMrF,EAAWqF,EAAIhF,OAAO,GAAGC,KACzBL,EAAWoF,EAAIhF,OAAO,GAAGE,KAEzBJ,EAAa,GAanB,OAZAkF,EAAIlF,WAAW1D,QAAQ,SAACxC,GACtBkG,EAAWlG,EAAQ1G,KAAO0G,EAAQhH,QAEpB,IAAIgB,EAAEqR,QAAQD,EAAIjF,KAAM,CACtCnC,KAAM,UACNsH,SAAU,CACRtH,KAAM,QACN7C,YAAa,CAAC4E,EAAUC,IAE1BuF,WAAYrF,KAIb3L,MAEHA,KAAK6C,OAAOoO,YAAYL,2CAYxB,IAAMM,EAAOlR,KAAK6C,OAAOsO,oBAEzBnR,KAAKc,WAAWqH,cAChBnI,KAAKc,WAAWsQ,QAAQF,sCAYxB,OAAOlR,KAAK6C,2CAWFwO,GACV,IAAMC,EAAUtR,KAAK6C,OAAO0O,eAAeF,GAC3CrR,KAAKwR,kBAAoB,CAACF,GAE1B,IACMjL,EADciL,EAAQG,cACF7K,YAE1B5G,KAAK0R,kBACL1R,KAAK2R,eAAe,CAACL,GAAUjL,GAAO,GAEtCrG,KAAKc,WAAW8Q,UAAUvL,GAC1BrG,KAAKc,WAAW+Q,QAAQ,oCAYxB7R,KAAKc,WAAWqH,cAChBnI,KAAK6C,OAAOsJ,+CAWCyE,EAAUvK,EAAOyL,GAAqB,IAAAC,EAAA/R,KAEnDA,KAAK0R,kBAGL1R,KAAKwR,kBAAoBZ,EAEzB,IAAMoB,EAAqBhS,KAAKiS,0BAA0BrB,GACpDsB,EAAazS,EAAE+D,SAASC,YAAY0O,IAAe,CACvDzL,OAAO,EACPiG,KAAMqF,EACNI,aAAa,IAETC,EAAiB,CACrBlN,KAAM,oBACNmC,MAAOtH,KAAK4C,YACZ2E,QAAS2K,GAEPzK,EAAQzH,KAAKc,WAAW4G,WACxBjI,EAAEW,MAAMQ,cAAc6G,KACxBA,EAAQ,IAAIhI,EAAEkI,MAAM,CAClB2K,mBAAoBR,EACpBS,IAAK,QAED3K,OAAOyK,GACbrS,KAAKc,WAAW+G,SAASJ,EAAO,CAAC+K,WAAWnM,EAAM,IAAKmM,WAAWnM,EAAM,OAExEoB,EAAMG,OAAOyK,GAGf5K,EAAM/B,GAAGjG,EAAEkG,IAAI8M,QAAS,WACtBV,EAAKL,iBAAgB,IACpB1R,wDAUqB4Q,GACxB,IAAM8B,EAAmB,CACvB9B,SAAU,IAkBZ,OAfAA,EAAS3I,QAAQ,SAACqJ,GAChB,IAAM3F,EAAa,GACbqF,EAAaM,EAAQqB,gBAC3BzU,OAAO0U,KAAK5B,GAAY/I,QAAQ,SAAC4K,EAAM9T,GACrC4M,EAAWvE,KAAK,CAAEyL,OAAMpU,MAAOuS,EAAW6B,OAM5C,IAAMC,EAAkB,CACtBnH,cAEF+G,EAAiB9B,SAASxJ,KAAK0L,KAE1BJ,0CAWOK,GACV/S,KAAKwR,kBAAkBzE,OAAS,IAClC/M,KAAKwR,kBAAkBzE,OAAS,EAE3BgG,GACH/S,KAAKc,WAAWqH,kDAYX,IAAA6K,EAAAhT,KACT,GAAIA,KAAKiT,UACPjT,KAAKuF,iBACA,CACL,IAAI2N,GAAgB,EACHlT,KAAKc,WAAWqS,cAExBC,KAAK,SAACC,GAKb,OAJ0B,IAAtBA,EAAQJ,WAAwBI,aAAmBL,IACrDvT,EAAE2I,OAAOpB,KAAT,wBAAA1B,OAAsC+N,EAAQtV,KAA9C,4BACAmV,GAAgB,GAEXA,KAGa,IAAlBA,GACFlT,KAAKc,WAAW4E,GAAGjG,EAAEkG,IAAI2N,MAAOtT,KAAKuT,UAAWvT,MAChDA,KAAKiT,WAAY,EACjBjT,KAAKyC,SAASQ,cAAc,6BAA6BqB,UAAUE,IAAI,aACvExE,KAAKyC,SAASQ,cAAc,sCAAsCqB,UAAUG,OAAO,cAEnFzE,KAAKiT,WAAY,wCAarBjT,KAAKc,WAAWqH,cAChBnI,KAAKc,WAAW0S,GAAG/T,EAAEkG,IAAI2N,MAAOtT,KAAKuT,UAAWvT,MAChDA,KAAKiT,WAAY,EACjBjT,KAAKyC,SAASQ,cAAc,6BAA6BqB,UAAUG,OAAO,yDAUxD5E,GAClB,OAAOA,EAAKoD,cAAc,qEAWrBwQ,GACL,IAAIC,GAAS,EAIb,OAHID,aAAejU,IACjBkU,EAAU1T,KAAKjC,OAAS0V,EAAI1V,MAEvB2V,oCAWP1T,KAAKmM,QACLnM,KAAKc,WAAW6O,eAAe1M,cAAc,kBAAkBqB,UAAUG,OAAO,aAChFzE,KAAKc,WAAW6S,aAAaC,cAAc5T,MAC3CA,KAAKc,WAAa,KAClBd,KAAK6C,OAAS,41BCjzCGgR,cAWnB,SAAAA,IAAiC,IAAA3T,EAArB4T,EAAqBC,UAAAhH,OAAA,QAAA7B,IAAA6I,UAAA,GAAAA,UAAA,GAAJ,gGAAIC,CAAAhU,KAAA6T,GAC3BpU,EAAEW,MAAMQ,cAAckT,IACxBrU,EAAEc,UAAU,yCAEdL,EAAA+T,EAAAjU,KAAAkU,EAAAL,GAAAlW,KAAAqC,QAOKmU,KAAO,KAOZjU,EAAKkU,UAAY,GAOjBlU,EAAKmU,eAAiB,KAQtBnU,EAAK2B,WAA0C,MAA7BiS,EAAejS,WAAqBiS,EAAejS,WADhD,gGAUrB3B,EAAKmB,QAAoC,MAA1ByS,EAAezS,QAAkByS,EAAezS,QAD7C,8GASlBnB,EAAKqB,UAAwC,MAA5BuS,EAAevS,UAAoBuS,EAAevS,UAD/C,4GASpBrB,EAAKuB,UAAwC,MAA5BqS,EAAerS,UAAoBqS,EAAerS,UAD/C,+FAzDW,OAkE/BvB,EAAKyB,UAAwC,MAA5BmS,EAAenS,UAAoBmS,EAAenS,UADhD,4GAQnBzB,EAAKoU,YAAcR,EAAeQ,aAAe,GAOjDpU,EAAKqU,UAAYC,EAAIC,SAhFUvU,wPAXmBT,EAAEiV,4CAsGhD9U,GACJI,KAAKW,QAAU,CACbkB,WAAY7B,KAAK6B,WACjBR,QAASrB,KAAKqB,QACdE,UAAWvB,KAAKuB,UAChBE,UAAWzB,KAAKyB,UAChBE,UAAW3B,KAAK2B,UAChB2S,YAAatU,KAAKsU,aAEpBtU,KAAKoU,UAAUhN,KAAK,IAAI5H,EAAgCQ,KAAKW,UAC7DX,KAAKmU,KAAOvU,EACZA,EAAI+P,eAAe1M,cAAc,kBAAkBqB,UAAUE,IAAI,aACjExE,KAAK2U,OAAS,IAAIlV,EAAEmV,GAAGC,MAAM,gCAAiC,CAC5DC,UAAW,aACXC,qBAAsB,gCACtBC,aAAa,EACbC,SAAUxV,EAAEmV,GAAGK,SAASC,GACxBjQ,QAAS,uBAEXjF,KAAK2U,OAAOjP,GAAGjG,EAAEkG,IAAIwP,aAAc,SAACtV,GAClCJ,EAAEW,MAAMgV,kBAAkBvV,KAE5BG,KAAK2U,OAAOU,YAAYrV,KAAKoU,WAC7BxU,EAAI0V,UAAUtV,KAAK2U,QAGf3U,KAAKW,QAAQ2T,YAAYiB,SAAWvV,KAAKW,QAAQ2T,YAAYvW,OAC/DiC,KAAKqU,eAAiB,IAAI5U,EAAEqD,MAAM0S,IAAI,CACpCC,IAAKzV,KAAKW,QAAQ2T,YAAYiB,QAC9BxX,KAAMiC,KAAKW,QAAQ2T,YAAYvW,KAC/B2X,OAAQ,WACRC,aAAa,EACbC,OAAO,IAET5V,KAAKmU,KAAK0B,OAAO7V,KAAKqU,iBAGxB,IAAMyB,EAAO9V,KACbA,KAAKoU,UAAU,GAAG1O,GAAGjG,EAAEkG,IAAIwP,aAAc,WACvCW,EAAKrI,KAAKhO,EAAEkG,IAAIwP,kDAYlBnV,KAAKmU,KAAK4B,eAAe/V,KAAKoU,WADtB,IAAA4B,EAEmC,CAAC,KAAM,KAAM,MAAvDhW,KAAKmU,KAFE6B,EAAA,GAEIhW,KAAKoU,UAFT4B,EAAA,GAEoBhW,KAAK2U,OAFzBqB,EAAA,yCAaR,OAAOhW,KAAKoU,oDAUZ,OAAOpU,KAAKoU,UAAU,GAAGlI,yDAWzB,OAAQlM,KAAKqU,qDAmBb,OAAOrU,KAAKuU,uCAXZ,MAAO,gECrMNnF,OAAO3P,EAAEwW,SAAQ7G,OAAO3P,EAAEwW,OAAS,IACnC7G,OAAO3P,EAAE4T,UAASjE,OAAO3P,EAAE4T,QAAU,IACrCjE,OAAO3P,EAAEC,OAAM0P,OAAO3P,EAAEC,KAAO,IAC/B0P,OAAO3P,EAAEC,KAAK2T,UAASjE,OAAO3P,EAAEC,KAAK2T,QAAU,IACpDjE,OAAO3P,EAAEwW,OAAOpC,yBAA2BqC,EAC3C9G,OAAO3P,EAAE4T,QAAQ7T,gCAAkC2W,EACnD/G,OAAO3P,EAAEC,KAAK2T,QAAQ7T,gCAAkC4W","file":"referencelocatorcatastro.ol.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","module.exports = \"<div id=\\\"referencelocatorcatastro-id\\\" class=\\\"m-control m-container m-referencelocatorcatastro-container\\\">\\n    <div class=\\\"header\\\">\\n        <!-- TITLE -->\\n        <!--<div class=\\\"titleBusquedaCatastral\\\">Búsqueda catastral</div>-->\\n        <button id=\\\"m-referencelocatorcatastro-button\\\" class=\\\"icon-navigation-busqueda-catastral\\\" title=\\\"Búsqueda catastral\\\"></button>\\n        <button id=\\\"m-catastrogetinfo-button\\\" class=\\\"g-cartografia-catastrogetinfo-button\\\" title=\\\"Consultar datos catastrales\\\"></button>\\n        <button id=\\\"m-catastroclear-button\\\" class=\\\"g-cartografia-papelera\\\" title=\\\"Limpiar resultados\\\"></button>\\n    </div>\\n    <div class=\\\"m-tabs-referencelocatorcatastro-container\\\">\\n        <ul id=\\\"m-tabs-referencelocatorcatastro\\\" class=\\\"group\\\">\\n            <li><a class=\\\"activated\\\">Referencia Catastral</a></li>\\n            <li><a>Búsqueda por polígono y parcela</a></li>\\n        </ul>\\n        <div id=\\\"m-tabs-referencelocatorcatastro-content\\\">\\n            <!-- Parámetros de búsqueda -->\\n            <div id=\\\"m-searchRC-container\\\" class=\\\"m-searchRC-tab m-tabcontent-referencelocatorcatastro show\\\">\\n                <input type=\\\"text\\\" id=\\\"m-searchRC-input\\\" class=\\\"g-cartografia-searchRC-input\\\" maxlength=\\\"20\\\" placeholder=\\\"Introduzca los 14 ó 20 dígitos de la RC\\\"></input>\\n                <div id=\\\"button-rc\\\" class=\\\"button\\\">\\n                    <button id=\\\"m-searchRC-button\\\" class=\\\"search\\\" title=\\\"Buscar\\\">\\n                        <i class=\\\"g-cartografia-zoom m-search-btn\\\"></i>Buscar\\n                    </button>\\n                    <button id=\\\"m-clearRC-button\\\" class=\\\"search\\\" title=\\\"Limpiar Resultados\\\">\\n                        <i class=\\\"g-cartografia-papelera m-search-btn\\\"></i>Limpiar\\n                    </button>\\n                </div>\\n            </div>\\n            <div id=\\\"m-searchParams-container\\\" class=\\\"m-searchParams-tab m-tabcontent-referencelocatorcatastro\\\">\\n                <label id=\\\"m-searchParamsProvincia-label\\\" class=\\\"g-cartografia-searchParamsProvincia-label\\\">Provincia:</label>\\n                <select id=\\\"m-searchParamsProvincia-select\\\" name=\\\"Provincias\\\" class=\\\"g-cartografia-searchParamsProvincia-select\\\">\\n                    <option value=\\\"0\\\">Seleccione una provincia</option>\\n                    <option value=\\\"04\\\">ALMERÍA</option>\\n                    <option value=\\\"11\\\">CÁDIZ</option>\\n                    <option value=\\\"14\\\">CÓRDOBA</option>\\n                    <option value=\\\"18\\\">GRANADA</option>\\n                    <option value=\\\"21\\\">HUELVA</option>\\n                    <option value=\\\"23\\\">JAÉN</option>\\n                    <option value=\\\"29\\\">MÁLAGA</option>\\n                    <option value=\\\"41\\\">SEVILLA</option>\\n                </select>\\n                <br>\\n                <label id=\\\"m-searchParamsMunicipio-label\\\" class=\\\"g-cartografia-searchParamsMunicipio-label\\\">Municipio:</label>\\n                <select id=\\\"m-searchParamsMunicipio-select\\\" name=\\\"Municipios\\\" class=\\\"g-cartografia-searchParamsMunicipio-select\\\">\\n                    <option value=\\\"0\\\">Seleccione un municipio</option>\\n                </select>\\n                <br>\\n                <label id=\\\"m-searchParamsPoligono-label\\\" class=\\\"g-cartografia-searchParamsPoligono-label\\\">Polígono:</label>\\n                <input type=\\\"text\\\" id=\\\"m-searchParamsPoligono-input\\\" class=\\\"g-cartografia-searchParamsPoligono-input\\\" placeholder=\\\"Introduzca un polígono\\\">\\n                <br>\\n                <label id=\\\"m-searchParamsParcela-label\\\" class=\\\"g-cartografia-searchParamsParcela-label\\\">Parcela:</label> <input type=\\\"text\\\" id=\\\"m-searchParamsParcela-input\\\" class=\\\"g-cartografia-searchParamsParcela-input\\\" placeholder=\\\"Introduzca una parcela\\\">\\n                <div id=\\\"button-params\\\" class=\\\"button\\\">\\n                    <button id=\\\"m-searchParams-button\\\" class=\\\"search\\\" title=\\\"Buscar\\\">\\n                        <i class=\\\"g-cartografia-zoom m-search-btn\\\"></i>Buscar\\n                    </button>\\n\\n                    <button id=\\\"m-clearParams-button\\\" class=\\\"search\\\" title=\\\"Limpiar Resultados\\\">\\n                        <i class=\\\"g-cartografia-papelera m-search-btn\\\"></i>Limpiar\\n                    </button>\\n                </div>\\n            </div>\\n        </div>\\n        <!-- Resultados de búsqueda -->\\n        <div id=m-referencelocatorcatastro-results>\\n            <!-- results searchRC -->\\n            <div id=\\\"m-searchRC-results\\\" class=\\\"m-searchRC m-tabcontent-referencelocatorcatastro results-panel show\\\">\\n                <div id=\\\"m-searching-result-searchRC\\\" class=\\\"m-searching-result g-cartografia-spinner\\\"></div>\\n            </div>\\n            <!-- results searchParams -->\\n            <div id=\\\"m-searchParams-results\\\" class=\\\"m-searchParams m-tabcontent-referencelocatorcatastro results-panel\\\">\\n                <div id=\\\"m-searching-result-searchParams\\\" class=\\\"m-searching-result g-cartografia-spinner\\\"></div>\\n            </div>\\n        </div>\\n    </div>\\n</div>\";","module.exports = \"<div class=\\\"catastro-results-panels\\\">\\n    {{#if partial}}\\n        <div class=\\\"partial\\\">\\n            <p>No se han encontrado resultados para la búsqueda.</p>\\n        </div>\\n    {{/if}}\\n    <div class=\\\"results\\\" id=\\\"m-catastro-results-scroll\\\">\\n        {{#each docs}}\\n            <div id=\\\"{{rcId}}\\\" class=\\\"result\\\">\\n                {{#each attributes}}\\n                    <table>\\n                        <tbody>\\n                            <tr>\\n                                <td class=\\\"key\\\">{{key}}</td>\\n                                <td class=\\\"value{{#oneword value}} m-wordbreak{{/oneword}}\\\">{{{value}}}</td>\\n                            </tr>\\n                        </tbody>\\n                    </table>\\n                {{/each}}\\n            </div>\\n        {{/each}}\\n    </div>\\n    {{#eq docs.length 0}}\\n        <div class=\\\"results\\\">\\n            <div class=\\\"partial\\\">No se han encontrado resultados para la búsqueda \\\"{{query}}\\\".</div>\\n        </div>\\n    {{/eq}}\\n    <div class=\\\"page\\\" id=\\\"currentPage\\\">\\n        <span class=\\\"found\\\" id=\\\"m-catastro-page-found\\\">{{docs.length}}</span> de <span class=\\\"total\\\">{{total}}</span>\\n    </div>\\n</div>\";","module.exports = \"<div class=\\\"m-catastrogetinfo-content\\\">\\n    {{#each features}}\\n        <div class=\\\"result\\\">\\n            {{#each attributes}}\\n                <table>\\n                    <tr>\\n                        <td class=\\\"key\\\"><b>{{key}}</b></td>\\n                        <td class=\\\"value{{#oneword value}} m-wordbreak{{/oneword}}\\\">{{{value}}}</td>\\n                    </tr>\\n                </table>\\n            {{/each}}\\n        </div>\\n        <div class=\\\"m-separator\\\"></div>\\n    {{/each}}\\n</div>\";","/**\n * @module M/impl/control/ReferenceLocatorCatastroControl\n */\nexport default class ReferenceLocatorCatastroControl extends M.impl.Control {\n  /**\n   * This function adds the control to the specified map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the plugin\n   * @param {HTMLElement} html of the plugin\n   * @api stable\n   */\n  addTo(map, html) {\n    super.addTo(map, html);\n  }\n}\n","/**\n * @module M/control/ReferenceLocatorCatastroControl\n */\n\nimport ReferenceLocatorCatastroImplControl from 'impl/referencelocatorcatastrocontrol';\nimport template from 'templates/referencelocatorcatastro';\nimport templateResults from 'templates/results';\nimport templatePopUp from 'templates/featurepopup';\n\nexport default class ReferenceLocatorCatastroControl extends M.Control {\n  /**\n   * @classdesc\n   * Main constructor of the class. Creates a PluginControl\n   * control\n   *\n   * @constructor\n   * @extends {M.Control}\n   * @api stable\n   */\n  constructor(parameters) {\n    if (M.utils.isUndefined(ReferenceLocatorCatastroImplControl)) {\n      M.exception('La implementación usada no puede crear controles ReferenceLocatorCatastroControl.');\n    }\n\n    const impl = new ReferenceLocatorCatastroImplControl();\n    super(impl, 'ReferenceLocatorCatastro');\n\n    if (parameters) {\n      this.options = (parameters || {});\n      this.config_ = (parameters || {});\n    } else {\n      M.exception('ReferenceLocatorCatastroControl: configuración no válida.');\n    }\n\n    if (M.utils.isUndefined(this.options.name) || M.utils.isNullOrEmpty(this.options.name)) {\n      this.options.name = this.NAME || 'ReferenceLocatorCatastro';\n    }\n\n    this.facadeMap_ = null;\n\n    /**\n     * Input element for RC\n     * @private\n     * @type {HTMLElement}\n     */\n    this.inputRC_ = null;\n\n    /**\n     * Select element for Provincias\n     * @private\n     * @type {HTMLElement}\n     */\n    this.selectProvincias = null;\n\n    /**\n     * Select element for Municipios\n     * @private\n     * @type {HTMLElement}\n     */\n    this.selectMunicipios = null;\n\n    /**\n     * Input element for Poligono\n     * @private\n     * @type {HTMLElement}\n     */\n    this.inputPoligono = null;\n\n    /**\n     * Input element for Parcela\n     * @private\n     * @type {HTMLElement}\n     */\n    this.inputParcela = null;\n\n    /**\n     * Url for \"consulta de municipios para una provincia\"\n     * @private\n     * @type {String}\n     */\n    this.ConsultaMunicipioCodigos_ = this.config_.CMC_url;\n\n    /**\n     * Url for \"consulta de datos no protegidos para un inmueble por su referencia catastral\"\n     * @private\n     * @type {String}\n     */\n    this.DNPRC_url_ = this.config_.DNPRC_url;\n\n    /**\n     * Url for \"consulta de coordenadas por Provincia, Municipio y Referencia Catastral\"\n     * @private\n     * @type {String}\n     */\n    this.CPMRC_url_ = this.config_.CPMRC_url;\n\n    /**\n     * Url for \"consulta de datos no protegidos para un inmueble por su polígono parcela\"\n     * @private\n     * @type {String}\n     */\n    this.DNPPP_url_ = this.config_.DNPPP_url;\n\n    /**\n     * Url for \"consulta de Referencia Catastral por Coordenadas\"\n     * @private\n     * @type {String}\n     */\n    this.RCCOOR_url_ = this.config_.RCCOOR_url;\n\n    /**\n     * Container of the results\n     * @private\n     * @type {HTMLElement}\n     */\n    this.resultsRCContainer_ = null;\n\n    /**\n     * Container of the results\n     * @private\n     * @type {HTMLElement}\n     */\n    this.resultsParamsContainer_ = null;\n\n    /**\n     * Container of the results to scroll\n     * @private\n     * @type {HTMLElement}\n     */\n    this.resultsScrollContainer_ = null;\n\n    /**\n     * Searching result\n     * @private\n     * @type {HTMLElement}\n     */\n    this.searchingRCResult_ = null;\n\n    /**\n     * Searching result\n     * @private\n     * @type {HTMLElement}\n     */\n    this.searchingParamsResult_ = null;\n\n    /**\n     * Timestamp of the search to abort old requests\n     * @private\n     * @type {Nunber}\n     */\n    this.searchTime_ = 0;\n\n    /**\n     * Results of the search\n     * @private\n     * @type {Array<Object>}\n     */\n    this.rcResults_ = [];\n\n    /**\n     * Results of the search\n     * @private\n     * @type {Array<Object>}\n     */\n    this.paramsResults_ = [];\n\n    /**\n     * Flag that indicates the scroll is up\n     * @private\n     * @type {Boolean}\n     */\n    this.scrollIsUp_ = true;\n\n    /**\n     * Draggable panel to show results\n     * @private\n     * @type {Object}\n     */\n    this.draggablePanel = null;\n\n    /**\n     * Indicates if the panel is minimized\n     * @private\n     * @type {Boolean}\n     */\n    this.panelMinimized = false;\n\n    /**\n     * Main control's html element\n     * @private\n     * @type {HTMLElement}\n     */\n    this.element_ = null;\n\n    /**\n     * Name of searching css class\n     * @const\n     * @type {string}\n     * @public\n     * @api stable\n     */\n    this.SEARCHING_CLASS = 'm-searching';\n\n    /**\n     * Name of hidden css class\n     * @const\n     * @type {string}\n     * @public\n     * @api stable\n     */\n    this.HIDDEN_RESULTS_CLASS = 'hidden';\n\n    /**\n     * Title for the popup\n     * @const\n     * @type {string}\n     * @public\n     * @api stable\n     */\n    this.POPUP_TITLE = 'Información catastral';\n\n    /**\n     * Result's layer. Invisible on TOC.\n     * @private\n     * @type {M.layer}\n     */\n    this.layer_ = new M.layer.GeoJSON({ name: 'Localizador Catastral', crs: '25830' });\n  }\n\n  /**\n   * This function adds events listeners to html elements\n   *\n   * @public\n   * @function\n   * @param {HTMLElement} element\n   * @api stable\n   */\n  addEvents_(html) {\n    this.element_ = html;\n\n    this.resultsRCContainer_ = this.element_.querySelector('div#m-searchRC-results');\n    this.searchingRCResult_ = this.element_.querySelector('div#m-searchRC-results > div#m-searching-result-searchRC');\n    this.resultsParamsContainer_ = this.element_.querySelector('div#m-searchParams-results');\n    this.searchingParamsResult_ = this.element_.querySelector('div#m-searchParams-results > div#m-searching-result-searchParams');\n  }\n\n  /**\n   * This function creates the view\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  createView(map) {\n    this.facadeMap_ = map;\n    this.facadeMap_.addLayers(this.layer_);\n    this.layer_.displayInLayerSwitcher = false;\n\n    return new Promise((success, fail) => {\n      const html = M.template.compileSync(template);\n      this.setStyle(html, this.options);\n      this.element_ = html;\n      this.createCatastroPanel();\n      this.addEvents_(this.element_);\n      this.togglePanel();\n      success(html);\n    });\n  }\n\n  /**\n   * This function compiles the template and makes a panel\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  createCatastroPanel() {\n    const searchRCContainer = this.element_.querySelector('div#m-searchRC-container');\n    const searchParamsContainer = this.element_.querySelector('div#m-searchParams-container');\n    const searchRCResults = this.element_.querySelector('div#m-searchRC-results');\n    const searchParamsResults = this.element_.querySelector('div#m-searchParams-results');\n    const searchRCTab = this.element_.querySelector('ul#m-tabs-referencelocatorcatastro > li:nth-child(1) > a');\n    const searchParamsTab = this.element_.querySelector('ul#m-tabs-referencelocatorcatastro > li:nth-child(2) > a');\n\n    searchRCTab.addEventListener('click', () => {\n      if (!searchRCTab.classList.contains('activated')) {\n        searchRCTab.classList.add('activated');\n        searchParamsTab.classList.remove('activated');\n        searchRCContainer.classList.add('show');\n        searchRCResults.classList.add('show');\n        searchParamsResults.classList.remove('show');\n        searchParamsContainer.classList.remove('show');\n      }\n    });\n\n    searchParamsTab.addEventListener('click', () => {\n      if (!searchParamsTab.classList.contains('activated')) {\n        searchParamsTab.classList.add('activated');\n        searchRCTab.classList.remove('activated');\n        searchRCContainer.classList.remove('show');\n        searchRCResults.classList.remove('show');\n        searchParamsResults.classList.add('show');\n        searchParamsContainer.classList.add('show');\n      }\n    });\n\n    this.inputRC_ = this.element_.querySelector('#m-searchRC-input');\n    this.inputRC_.addEventListener('keyup', this.onRCSearch.bind(this));\n\n    const catstroSearch = this.element_.querySelector('#m-referencelocatorcatastro-button');\n    catstroSearch.addEventListener('click', this.activeSearch.bind(this));\n\n    const castastroInfo = this.element_.querySelector('#m-catastrogetinfo-button');\n    castastroInfo.addEventListener('click', this.activeInfo.bind(this));\n\n    const buttonClear = this.element_.querySelector('#m-catastroclear-button');\n    buttonClear.addEventListener('click', this.clearResults.bind(this));\n\n    this.selectProvincias = this.element_.querySelector('#m-searchParamsProvincia-select');\n    this.selectProvincias.addEventListener('change', this.onProvinciaSelect.bind(this));\n\n    this.selectMunicipios = this.element_.querySelector('#m-searchParamsMunicipio-select');\n    this.inputPoligono = this.element_.querySelector('#m-searchParamsPoligono-input');\n    this.inputParcela = this.element_.querySelector('#m-searchParamsParcela-input');\n\n    const buttonRCSearch = this.element_.querySelector('#m-searchRC-button');\n    buttonRCSearch.addEventListener('click', this.onRCSearch.bind(this));\n\n    const buttonParamsSearch = this.element_.querySelector('#m-searchParams-button');\n    buttonParamsSearch.addEventListener('click', e => this.onParamsSearch(e));\n\n    const buttonClearRC = this.element_.querySelector('#m-clearRC-button');\n    buttonClearRC.addEventListener('click', this.clearResults.bind(this));\n\n    const buttonClearParams = this.element_.querySelector('#m-clearParams-button');\n    buttonClearParams.addEventListener('click', this.clearResults.bind(this));\n  }\n\n  /**\n   * This function sets user defined style options to button\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  setStyle(html, options) {\n    if (!M.utils.isUndefined(options.tooltip) && !M.utils.isNullOrEmpty(options.tooltip)) {\n      html.querySelector('button').setAttribute('title', options.tooltip);\n    }\n    if (!M.utils.isUndefined(options.icon) && !M.utils.isNullOrEmpty(options.icon)) {\n      html.querySelector('button').setAttribute('class', options.icon);\n    }\n    if (!M.utils.isUndefined(options.order) && !M.utils.isNullOrEmpty(options.order)) {\n      html.querySelector('button').parentNode.setAttribute('style', `order: ${options.order}`);\n    }\n  }\n\n  /**\n   * Set search control active\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  activeSearch() {\n    this.deactivate();\n    this.togglePanel();\n    const classList = this.element_.querySelector('#m-referencelocatorcatastro-button').classList;\n    if (classList.contains('activated')) {\n      classList.remove('activated');\n    } else {\n      classList.add('activated');\n    }\n  }\n\n  /**\n   * Set catastro info button active\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  activeInfo() {\n    if (this.panelMinimized === false) {\n      this.togglePanel();\n    }\n    this.activate();\n  }\n\n  /**\n   * This function adds clear and close events listener to element\n   *\n   * @public\n   * @function\n   * @param {HTMLElement} element\n   * @api stable\n   * @export\n   */\n  addClearEvents(element) {\n    this.on(M.evt.COMPLETED, () => {\n      element.classList.add('shown');\n    });\n\n    const buttonClearRC = element.querySelector('#m-clearRC-button');\n    buttonClearRC.addEventListener('click', this.clearResults.bind(this));\n\n    const buttonClearParams = element.querySelector('#m-clearParams-button');\n    buttonClearParams.addEventListener('click', this.clearResults.bind(this));\n\n    const buttonClose = element.querySelector('#dialog-close-catastro');\n    buttonClose.addEventListener('click', this.clearResults.bind(this));\n  }\n\n  /**\n   * This function clears selects, inputs and result info from panel\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  clearResults() {\n    this.clearClick_();\n  }\n\n  /**\n   * This function builds the query URL and shows results\n   *\n   * @private\n   * @function\n   * @param {ol.MapBrowserPointerEvent} evt - Browser point event\n   */\n  buildUrl_(evt) {\n    const options = {\n      jsonp: true,\n    };\n\n    const srs = this.facadeMap_.getProjection().code;\n\n    M.remote.get(this.RCCOOR_url_, {\n      SRS: srs,\n      Coordenada_X: evt.coord[0],\n      Coordenada_Y: evt.coord[1],\n    }).then((res) => {\n      this.showInfoFromURL_(res, evt.coord);\n    }, options);\n  }\n\n  /**\n   * This function displays information in a popup\n   *\n   * @private\n   * @function\n   * @param {XML} response - response from the petition\n   * @param {array} coordinate - Coordinate position onClick\n   */\n  showInfoFromURL_(response, coordinates) {\n    // TODO: Si existe una capa KML en el punto donde se ha pinchado, no se respetara su popup, ya\n    // que las coordenadas del mismo seran las del kml,\n    // y es muy probable que no coincidan con las del\n    // click, ya que para kmls se trabaja con un margen amplio de pixeles\n    if ((response.code === 200) && (response.error === false)) {\n      const infos = [];\n      const info = response.text;\n      const formatedInfo = this.formatInfo_(info);\n      infos.push(formatedInfo);\n\n      const tab = {\n        icon: 'g-cartografia-pin',\n        title: this.POPUP_TITLE,\n        content: infos.join(''),\n      };\n\n      let popup = this.facadeMap_.getPopup();\n\n      if (M.utils.isNullOrEmpty(popup)) {\n        popup = new M.Popup();\n        popup.addTab(tab);\n        this.facadeMap_.addPopup(popup, coordinates);\n      } else if (popup.getCoordinate()[0] === coordinates[0] && popup.getCoordinate()[1] === coordinates[1]) {\n        // Si es un popup que está en la misma coordenada\n        // Vemos si tiene pestañas de otros controles\n        let hasExternalContent = false;\n        popup.getTabs().forEach((t) => {\n          if (t.title !== this.POPUP_TITLE) {\n            hasExternalContent = true;\n          } else {\n            popup.removeTab(t);\n          }\n        });\n        if (hasExternalContent) {\n          popup.addTab(tab);\n        } else {\n          // Es del mismo catastro, podemos borrarlo\n          popup = new M.Popup();\n          popup.addTab(tab);\n          this.facadeMap_.addPopup(popup, coordinates);\n        }\n      } else {\n        popup = new M.Popup();\n        popup.addTab(tab);\n        this.facadeMap_.addPopup(popup, coordinates);\n      }\n    } else {\n      this.facadeMap_.removePopup();\n      M.dialog.error('MAPEA: No es posible establecer la conexión con el servidor de Catastro.');\n    }\n  }\n\n  /**\n   * This function formats the response\n   *\n   * @param {string} info - Information to formatting\n   * @returns {string} information - Formatted information\n   * @private\n   * @function\n   */\n  formatInfo_(info) {\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(info, 'text/xml');\n    let ldtNode;\n    let valuePopup;\n    let codProv;\n    let codMun;\n\n    const rootElement = xmlDoc.getElementsByTagName('consulta_coordenadas')[0];\n    const controlNode = rootElement.getElementsByTagName('control')[0];\n    const errorCtlNode = controlNode.getElementsByTagName('cuerr')[0].childNodes[0].nodeValue;\n    if (errorCtlNode === '1') {\n      const errorNode = rootElement.getElementsByTagName('lerr')[0];\n      const errorDesc = errorNode.getElementsByTagName('err')[0];\n      const errorDescTxt = errorDesc.getElementsByTagName('des')[0].childNodes[0].nodeValue;\n      valuePopup = errorDescTxt;\n    } else {\n      const coordenadasNode = rootElement.getElementsByTagName('coordenadas')[0];\n      const coordNode = coordenadasNode.getElementsByTagName('coord')[0];\n      const pcNode = coordNode.getElementsByTagName('pc')[0];\n      const pc1Node = pcNode.getElementsByTagName('pc1')[0].childNodes[0].nodeValue;\n      const pc2Node = coordNode.getElementsByTagName('pc2')[0].childNodes[0].nodeValue;\n\n      // Obtenemos códigos de provincia y municipio\n      codProv = pc1Node.substring(0, 2);\n      codMun = pc1Node.substring(2, 5);\n\n      ldtNode = coordNode.getElementsByTagName('ldt')[0].childNodes[0].nodeValue;\n      valuePopup = pc1Node + pc2Node;\n    }\n\n    // Sacar a variable la url\n    const link = `https://www1.sedecatastro.gob.es/CYCBienInmueble/OVCConCiud.aspx?UrbRus=&RefC=${valuePopup}&esBice=&RCBice1=&RCBice2=&DenoBice=&from=OVCBusqueda&pest=rc&RCCompleta=${valuePopup}&final=&del=${codProv}&mun=${codMun}`;\n\n    const formatedInfo = `${M.utils.beautifyAttribute('Información Catastral')}\n    <div class='divinfo'>\n    <table class='mapea-table'>\n    <tbody>\n    <tr><td class='header' colspan='4'></td></tr>\n    <tr><td class='key'><b>${M.utils.beautifyAttribute('Referencia catastral')}</b></td><td class='value'></b>\n    <a href='${link}' target='_blank'>${valuePopup}</a></td></tr>\n    <tr><td class='key'><b>${M.utils.beautifyAttribute('Descripción')}</b></td>\n    <td class='value'>${ldtNode}</td></tr>\n    </tbody></table></div>`;\n\n    return formatedInfo;\n  }\n\n  /**\n   * Toggle panel\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  togglePanel() {\n    const panelContent = this.element_.querySelector('.m-tabs-referencelocatorcatastro-container');\n    if (this.panelMinimized === false) {\n      this.panelMinimized = true;\n      panelContent.style.display = 'none';\n    } else {\n      this.panelMinimized = false;\n      panelContent.style.display = 'inline';\n    }\n  }\n\n  /**\n   * Handler for search with RC button\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  onRCSearch(evt) {\n    evt.preventDefault();\n    if ((evt.type !== 'keyup') || (evt.keyCode === 13)) {\n      let inputRC = this.inputRC_ && this.inputRC_.value;\n      if (M.utils.isNullOrEmpty(inputRC)) {\n        M.dialog.info('Debe introducir una referencia catastral');\n      } else {\n        inputRC = inputRC.substr(0, 14);\n        const searchUrl = M.utils.addParameters(this.CPMRC_url_, {\n          Provincia: '',\n          Municipio: '',\n          SRS: this.facadeMap_.getProjection().code,\n          RC: inputRC,\n        });\n        this.search_(searchUrl, this.resultsRCContainer_, this.searchingRCResult_, this.showResults_);\n      }\n    }\n  }\n\n  /**\n   * Handler for search with params button\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  onParamsSearch(evt) {\n    evt.preventDefault();\n\n    if ((evt.type !== 'keyup') || (evt.keyCode === 13)) {\n      if (M.utils.isNullOrEmpty(this.selectProvincias.value) || this.selectProvincias.value === '0') {\n        M.dialog.info('Debe seleccionar una provincia.');\n        return;\n      }\n      if (M.utils.isNullOrEmpty(this.selectMunicipios.value) || this.selectMunicipios.value === '0') {\n        M.dialog.info('Debe seleccionar un municpio.');\n        return;\n      }\n      if (M.utils.isNullOrEmpty(this.inputPoligono.value)) {\n        M.dialog.info('Debe introducir un polígono.');\n        return;\n      }\n      if (M.utils.isNullOrEmpty(this.inputParcela.value)) {\n        M.dialog.info('Debe introducir una parcela.');\n        return;\n      }\n\n      const searchUrl = M.utils.addParameters(this.DNPPP_url_, {\n        CodigoProvincia: this.selectProvincias.value,\n        CodigoMunicipio: this.selectMunicipios.value,\n        CodigoMunicipioINE: '',\n        Poligono: this.inputPoligono.value,\n        Parcela: this.inputParcela.value,\n      });\n      this.search_(searchUrl, this.resultsParamsContainer_, this.searchingParamsResult_, this.showResults_);\n    }\n  }\n\n  /**\n   * Does the GET petition to search\n   *\n   * @private\n   * @function\n   */\n  search_(searchUrl, container, searchingResult, processor) {\n    container.appendChild(searchingResult);\n    this.element_.classList.add(this.SEARCHING_CLASS);\n\n    M.remote.get(searchUrl).then((response) => {\n      const success = this.acceptOVCSW(response);\n      if (success) {\n        processor.call(this, response.xml, container);\n      }\n      this.element_.classList.remove(this.SEARCHING_CLASS);\n    });\n  }\n\n  /**\n   * Checks if response is valid\n   *\n   * @private\n   * @function\n   */\n  acceptOVCSW(response) {\n    let success = true;\n    try {\n      if ((response.code === 200) && (response.error === false)) {\n        const results = response.xml;\n        const rootElement = results.childNodes[0];\n        const controlNode = rootElement.getElementsByTagName('control')[0];\n        const errorCtlNode = controlNode.getElementsByTagName('cuerr')[0];\n        let cuerr = '0';\n        if (errorCtlNode !== undefined) {\n          cuerr = errorCtlNode.childNodes[0].nodeValue;\n        }\n        if (cuerr === '1') {\n          const errorNode = rootElement.getElementsByTagName('lerr')[0];\n          const errorDesc = errorNode.getElementsByTagName('err')[0];\n          const errorDescTxt = errorDesc.getElementsByTagName('des')[0].childNodes[0].nodeValue;\n          this.element_.classList.remove(this.SEARCHING_CLASS);\n          success = false;\n          M.dialog.info(errorDescTxt);\n        }\n      } else {\n        success = false;\n        M.dialog.error('MAPEA: No es posible establecer la conexión con el servidor de Catastro.');\n      }\n    } catch (err) {\n      success = false;\n      M.exception(`La respuesta no es un JSON válido: ${err}.`);\n    }\n    return success;\n  }\n\n  /**\n   * Parses CPMRC results\n   *\n   * @private\n   * @function\n   */\n  parseCPMRCResults(xmlResults) {\n    const rootElement = xmlResults.getElementsByTagName('consulta_coordenadas')[0];\n    const coordenadasNode = rootElement.getElementsByTagName('coordenadas')[0];\n    const coordNode = coordenadasNode.getElementsByTagName('coord')[0];\n\n    const pcNode = coordNode.getElementsByTagName('pc')[0];\n    const pc1Node = pcNode.getElementsByTagName('pc1')[0].childNodes[0].nodeValue;\n    const pc2Node = pcNode.getElementsByTagName('pc2')[0].childNodes[0].nodeValue;\n\n    const geoNode = coordNode.getElementsByTagName('geo')[0];\n    const xcenNode = geoNode.getElementsByTagName('xcen')[0].childNodes[0].nodeValue;\n    const ycenNode = geoNode.getElementsByTagName('ycen')[0].childNodes[0].nodeValue;\n    const srsNode = geoNode.getElementsByTagName('srs')[0].childNodes[0].nodeValue;\n\n    const ldtNode = coordNode.getElementsByTagName('ldt')[0].childNodes[0].nodeValue;\n\n    return {\n      attributes: [{\n        key: 'Referencia Catastral',\n        value: pc1Node + pc2Node,\n      }, {\n        key: 'Descripción',\n        value: ldtNode,\n      }],\n      rcId: `rc_${pc1Node}${pc2Node}`,\n      coords: [{\n        xcen: xcenNode,\n        ycen: ycenNode,\n        srs: srsNode,\n      }],\n    };\n  }\n\n  /**\n   * This function parses results and compiles template\n   * with vars to show results\n   *\n   * @private\n   * @function\n   */\n  showResults_(results, container) {\n    this.getLayer().clear();\n\n    let resultsTemplateVars = {};\n    if (container === this.resultsRCContainer_) {\n      resultsTemplateVars = this.parseRCResultsForTemplate_(results, false);\n    } else if (container === this.resultsParamsContainer_) {\n      resultsTemplateVars = this.parseParamsResultsForTemplate_(results, false);\n      // this.parseParamsResultsForTemplate_(results, false).then((res) => {\n      //   resultsTemplateVars = res;\n      // });\n    }\n\n    Promise.resolve(resultsTemplateVars).then((resultTemplate) => {\n      this.drawResults(resultTemplate);\n      const html = M.template.compileSync(templateResults, { vars: resultTemplate });\n      container.classList.remove(this.HIDDEN_RESULTS_CLASS);\n      let resultsHtmlElements = container.querySelectorAll('.result');\n      let resultHtml;\n      for (let i = 0, ilen = resultsHtmlElements.length; i < ilen; i += 1) {\n        resultHtml = resultsHtmlElements.item(i);\n        resultHtml.removeEventListener('click', this.resultClick_.bind(this));\n      }\n\n      this.zoomToResults();\n\n      const btnResults = container.querySelector('div.page > div.g-cartografia-flecha-arriba');\n      if (!M.utils.isNullOrEmpty(btnResults)) {\n        btnResults.removeEventListener('click', this.resultsClick_.bind(this));\n      }\n\n      // gets the new results scroll\n      // eslint-disable-next-line no-param-reassign\n      container.innerHTML = html.innerHTML;\n      this.resultsScrollContainer_ = container.querySelector('div#m-catastro-results-scroll');\n      this.resultsScrollContainer_.scrollIntoView(false);\n      // adds new events\n      resultsHtmlElements = container.getElementsByClassName('result');\n      for (let i = 0, ilen = resultsHtmlElements.length; i < ilen; i += 1) {\n        resultHtml = resultsHtmlElements.item(i);\n        resultHtml.addEventListener('click', this.resultClick_.bind(this));\n      }\n      this.fire(M.evt.COMPLETED);\n    });\n  }\n\n  /**\n   * This function parses results from RC search for template\n   *\n   * @private\n   * @function\n   */\n  parseRCResultsForTemplate_(results, append) {\n    const docs = this.parseCPMRCResults(results);\n    if (append === true) {\n      this.rcResults_.unshift(docs);\n    } else {\n      this.rcResults_ = [docs];\n    }\n\n    return {\n      docs: this.rcResults_,\n      total: this.rcResults_.length,\n      partial: false,\n      notResutls: false,\n      query: this.inputRC_.value,\n    };\n  }\n\n  /**\n   * This function parses results from params search for template\n   *\n   * @private\n   * @function\n   */\n  parseParamsResultsForTemplate_(results, append) {\n    const rootElement = results.getElementsByTagName('consulta_dnp')[0];\n    let descripcion = 'N/A';\n    let rcNode;\n    let cnValue = 'UR';\n    const lrcdnpNode = rootElement.getElementsByTagName('lrcdnp');\n\n    if (lrcdnpNode.length > 0) {\n      const rcdnpNode = lrcdnpNode[0].getElementsByTagName('rcdnp')[0];\n      rcNode = rcdnpNode.getElementsByTagName('rc')[0];\n      const dtNode = rcdnpNode.getElementsByTagName('dt')[0];\n      const npNode = dtNode.getElementsByTagName('np')[0].childNodes[0].nodeValue;\n      const nmNode = dtNode.getElementsByTagName('nm')[0].childNodes[0].nodeValue;\n      const locsNode = dtNode.getElementsByTagName('locs')[0];\n      const lorsNode = locsNode.getElementsByTagName('lors')[0];\n      const lorusNode = lorsNode.getElementsByTagName('lorus')[0];\n      const npaNode = lorusNode.getElementsByTagName('npa')[0].childNodes[0].nodeValue;\n      const cpajNode = lorusNode.getElementsByTagName('cpaj')[0].childNodes[0].nodeValue;\n      descripcion = `${npaNode} ${cpajNode}. ${nmNode} (${npNode})`;\n    } else {\n      const bicoNode = rootElement.getElementsByTagName('bico')[0];\n      const biNode = bicoNode.getElementsByTagName('bi')[0];\n      const idbiNode = biNode.getElementsByTagName('idbi')[0];\n      cnValue = idbiNode.getElementsByTagName('cn')[0].childNodes[0].nodeValue;\n      rcNode = idbiNode.getElementsByTagName('rc')[0];\n      descripcion = biNode.getElementsByTagName('ldt')[0].childNodes[0].nodeValue;\n    }\n\n    const pc1Value = rcNode.getElementsByTagName('pc1')[0].childNodes[0].nodeValue;\n    const pc2Value = rcNode.getElementsByTagName('pc2')[0].childNodes[0].nodeValue;\n    const paramsId = this.selectProvincias.value + this.selectMunicipios.value + this.inputPoligono.value + this.inputParcela.value;\n    const searchUrl = M.utils.addParameters(this.CPMRC_url_, {\n      Provincia: '',\n      Municipio: '',\n      SRS: this.facadeMap_.getProjection().code,\n      RC: pc1Value + pc2Value,\n    });\n\n    return M.remote.get(searchUrl).then((response) => {\n      const success = this.acceptOVCSW(response);\n      if (success) {\n        const docsRC = this.parseCPMRCResults(response.xml);\n        const xcen = docsRC.coords[0].xcen;\n        const ycen = docsRC.coords[0].ycen;\n        const srs = docsRC.coords[0].srs;\n        const docs = {\n          attributes: [{\n            key: 'Referencia Catastral',\n            value: pc1Value + pc2Value,\n          }, {\n            key: 'Descripción',\n            value: descripcion,\n          }, {\n            key: 'Tipo',\n            value: cnValue,\n          }],\n          paramsId,\n          rcId: `rc_${pc1Value}${pc2Value}`,\n          coords: [{\n            xcen,\n            ycen,\n            srs,\n          }],\n        };\n        if (append === true) {\n          this.paramsResults_.unshift(docs);\n        } else {\n          this.paramsResults_ = [docs];\n        }\n\n        return {\n          docs: this.paramsResults_,\n          total: this.paramsResults_.length,\n          partial: false,\n          notResutls: false,\n          query: pc1Value + pc2Value,\n        };\n      }\n      return 'Unsuccessful response.';\n    });\n  }\n\n  /**\n   * Result button click handler\n   *\n   * @private\n   * @function\n   */\n  resultClick_(evt) {\n    evt.preventDefault();\n    // hidden results on click for mobile devices\n    if (M.window.WIDTH <= M.config.MOBILE_WIDTH) {\n      // TODO?\n      // evt.target = this.facadeMap_.getContainer()\n      // .querySelector('div.page > div.g-cartografia-flecha-arriba');\n      // this.resultsClick_(evt);\n    }\n    this.facadeMap_.removePopup();\n    const rcId = evt.currentTarget.id;\n    this.resultClick(rcId);\n  }\n\n  /**\n   * Clear button click handler\n   * Clears selects, inputs and result info from panel.\n   *\n   * @private\n   * @function\n   */\n  clearClick_() {\n    this.element_.classList.remove('shown');\n\n    if (!M.utils.isNullOrEmpty(this.inputRC_)) {\n      this.inputRC_.value = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.selectProvincias)) {\n      this.selectProvincias.value = '0';\n    }\n    if (!M.utils.isNullOrEmpty(this.selectMunicipios)) {\n      this.selectMunicipios.value = '0';\n    }\n    if (!M.utils.isNullOrEmpty(this.inputPoligono)) {\n      this.inputPoligono.value = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.inputParcela)) {\n      this.inputParcela.value = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.resultsRCContainer_)) {\n      this.resultsRCContainer_.innerHTML = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.resultsParamsContainer_)) {\n      this.resultsParamsContainer_.innerHTML = '';\n    }\n    if (!M.utils.isNullOrEmpty(this.resultsScrollContainer_)) {\n      this.resultsScrollContainer_.innerHTML = '';\n      this.resultsScrollContainer_ = null;\n    }\n    if (!M.utils.isNullOrEmpty(this.rcResults_)) {\n      this.rcResults_.length = 0;\n    } else {\n      this.rcResults_ = [];\n    }\n    if (!M.utils.isNullOrEmpty(this.paramsResults_)) {\n      this.paramsResults_.length = 0;\n    } else {\n      this.paramsResults_ = [];\n    }\n\n    this.resultsRCContainer_.classList.remove(this.HIDDEN_RESULTS_CLASS);\n    this.resultsParamsContainer_.classList.remove(this.HIDDEN_RESULTS_CLASS);\n    this.clear();\n  }\n\n  /**\n   * Handler for click on results button\n   *\n   * @private\n   * @function\n   */\n  resultsClick_(evt) {\n    this.facadeMap_.areasContainer.getElementsByClassName('m-top m-right')[0].classList.add('top-extra-search');\n    evt.target.classlist.toggle('g-cartografia-flecha-arriba');\n    evt.target.classlist.toggle('g-cartografia-flecha-abajo');\n    this.resultsRCContainer_.classlist.toggle(this.HIDDEN_RESULTS_CLASS);\n    this.resultsParamsContainer_.classlist.toggle(this.HIDDEN_RESULTS_CLASS);\n  }\n\n  /**\n   * Handler for selecting an option on Provincia select\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  onProvinciaSelect(e) {\n    const elt = e.target;\n    const provinceCode = elt.value;\n    if (provinceCode !== '0') {\n      M.remote.get(this.ConsultaMunicipioCodigos_, {\n        CodigoProvincia: provinceCode,\n        CodigoMunicipio: '',\n        CodigoMunicipioIne: '',\n      }).then((res) => {\n        this.loadMunicipiosSelect(res);\n      });\n    } else {\n      this.clearMunicipiosSelect();\n    }\n  }\n\n  /**\n   * Clears options set to Municipios select\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  clearMunicipiosSelect() {\n    const select = this.element_.getElementsByTagName('select')['m-searchParamsMunicipio-select'];\n    while (select.firstChild) {\n      select.removeChild(select.firstChild);\n    }\n    const option = document.createElement('option');\n    option.value = '0';\n    option.innerHTML = 'Seleccione un municipio';\n    select.appendChild(option);\n  }\n\n  /**\n   * Loads and renders options set to Municipios select\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  loadMunicipiosSelect(response) {\n    if ((response.code === 200) && (response.error === false)) {\n      const rootElement = response.xml.getElementsByTagName('consulta_municipiero')[0];\n      const rootMunicipios = rootElement.getElementsByTagName('municipiero')[0];\n      const muniNodes = rootMunicipios.getElementsByTagName('muni');\n      const select = this.element_.getElementsByTagName('select')['m-searchParamsMunicipio-select'];\n      this.clearMunicipiosSelect();\n      for (let i = 0; i < muniNodes.length; i += 1) {\n        const option = document.createElement('option');\n        const locat = muniNodes[i].getElementsByTagName('locat')[0];\n        option.value = locat.getElementsByTagName('cmc')[0].childNodes[0].nodeValue;\n        option.innerHTML = muniNodes[i].getElementsByTagName('nm')[0].childNodes[0].nodeValue;\n        select.appendChild(option);\n      }\n    } else {\n      M.dialog.error('MAPEA: No es posible establecer la conexión con el servidor de Catastro.');\n    }\n  }\n\n  /**\n   * This function draws the results into the specified map\n   *\n   * @public\n   * @function\n   * @param {Array<Object>} results to draw\n   * @api stable\n   */\n  drawResults(results) {\n    let docs = [];\n\n    if (M.utils.isNullOrEmpty(docs)) {\n      docs = results.docs;\n    }\n\n    const features = docs.map((doc) => {\n      const xcenNode = doc.coords[0].xcen;\n      const ycenNode = doc.coords[0].ycen;\n\n      const attributes = {};\n      doc.attributes.forEach((element) => {\n        attributes[element.key] = element.value;\n      });\n      const feature = new M.Feature(doc.rcId, {\n        type: 'Feature',\n        geometry: {\n          type: 'Point',\n          coordinates: [xcenNode, ycenNode],\n        },\n        properties: attributes,\n      });\n\n      return feature;\n    }, this);\n    // TODO: Aplicar estilo a capa Catastro? se puede cambiar desde fuera\n    this.layer_.addFeatures(features);\n  }\n\n  /**\n   * This function zooms the view to the results on layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  zoomToResults() {\n    const bbox = this.layer_.getFeaturesExtent();\n\n    this.facadeMap_.removePopup();\n    this.facadeMap_.setBbox(bbox);\n  }\n\n  /**\n   * This function returns the layer used\n   *\n   * @public\n   * @function\n   * @returns {ol.layer.Vector}\n   * @api stable\n   */\n  getLayer() {\n    return this.layer_;\n  }\n\n  /**\n   * TODO\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  resultClick(rcid) {\n    const feature = this.layer_.getFeatureById(rcid);\n    this.selectedFeatures_ = [feature];\n\n    const featureGeom = feature.getGeometry();\n    const coord = featureGeom.coordinates;\n\n    this.unselectResults();\n    this.selectFeatures([feature], coord, true);\n\n    this.facadeMap_.setCenter(coord);\n    this.facadeMap_.setZoom(15);\n  }\n\n  /**\n   * This function clears the layer\n   *\n   * @public\n   * @function\n   * @param {M.Map} map to add the control\n   * @api stable\n   */\n  clear() {\n    this.facadeMap_.removePopup();\n    this.layer_.clear();\n  }\n\n  /**\n   * This function checks if an object is equals\n   * to this layer\n   * @public\n   * @function\n   * @param {ol.Feature} feature\n   * @api stable\n   */\n  selectFeatures(features, coord, noPanMapIfOutOfView) {\n    // unselects previous features\n    this.unselectResults();\n\n    // sets the style\n    this.selectedFeatures_ = features;\n\n    const featureForTemplate = this.parseFeaturesForTemplate_(features);\n    const htmlAsText = M.template.compileSync(templatePopUp, {\n      jsonp: false,\n      vars: featureForTemplate,\n      parseToHtml: false,\n    });\n    const featureTabOpts = {\n      icon: 'g-cartografia-pin',\n      title: this.POPUP_TITLE,\n      content: htmlAsText,\n    };\n    let popup = this.facadeMap_.getPopup();\n    if (M.utils.isNullOrEmpty(popup)) {\n      popup = new M.Popup({\n        panMapIfOutOfView: !noPanMapIfOutOfView,\n        ani: null,\n      });\n      popup.addTab(featureTabOpts);\n      this.facadeMap_.addPopup(popup, [parseFloat(coord[0]), parseFloat(coord[1])]);\n    } else {\n      popup.addTab(featureTabOpts);\n    }\n    // removes events on destroy\n    popup.on(M.evt.DESTROY, () => {\n      this.unselectResults(true);\n    }, this);\n  }\n\n  /**\n   * This function checks if an object is equals\n   * to this control\n   *\n   * @private\n   * @function\n   */\n  parseFeaturesForTemplate_(features) {\n    const featuresTemplate = {\n      features: [],\n    };\n\n    features.forEach((feature) => {\n      const attributes = [];\n      const properties = feature.getAttributes();\n      Object.keys(properties).forEach((elem, key) => {\n        attributes.push({ elem, value: properties[elem] });\n      });\n      // Old code:\n      // for (const key in properties) {\n      //   attributes.push({ key, value: properties[key] });\n      // }\n      const featureTemplate = {\n        attributes,\n      };\n      featuresTemplate.features.push(featureTemplate);\n    });\n    return featuresTemplate;\n  }\n\n  /**\n   * TODO\n   *\n   * @public\n   * @function\n   * @param {boolean} keepPopup to draw\n   * @api stable\n   */\n  unselectResults(keepPopup) {\n    if (this.selectedFeatures_.length > 0) {\n      this.selectedFeatures_.length = 0;\n      // removes the popup just when event destroy was not fired\n      if (!keepPopup) {\n        this.facadeMap_.removePopup();\n      }\n    }\n  }\n\n  /**\n   * This function is called on the control activation\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  activate() {\n    if (this.activated) {\n      this.deactivate();\n    } else {\n      let someCtlActive = false;\n      const controls = this.facadeMap_.getControls();\n      // TODO: check if this should be: someCtlActive = controls.some(...)\n      controls.some((control) => {\n        if (control.activated === true && !(control instanceof this)) {\n          M.dialog.info(`Desactive el control ${control.name} antes de activar este.`);\n          someCtlActive = true;\n        }\n        return someCtlActive;\n      });\n\n      if (someCtlActive === false) {\n        this.facadeMap_.on(M.evt.CLICK, this.buildUrl_, this);\n        this.activated = true;\n        this.element_.querySelector('#m-catastrogetinfo-button').classList.add('activated');\n        this.element_.querySelector('#m-referencelocatorcatastro-button').classList.remove('activated');\n      } else {\n        this.activated = false;\n      }\n    }\n  }\n\n  /**\n   * This function is called on the control deactivation\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  deactivate() {\n    this.facadeMap_.removePopup();\n    this.facadeMap_.un(M.evt.CLICK, this.buildUrl_, this);\n    this.activated = false;\n    this.element_.querySelector('#m-catastrogetinfo-button').classList.remove('activated');\n  }\n  /**\n   * This function gets activation button\n   *\n   * @public\n   * @function\n   * @param {HTML} html of control\n   * @api stable\n   */\n  getActivationButton(html) {\n    return html.querySelector('.m-referencelocatorcatastro button');\n  }\n\n  /**\n   * This function compares controls\n   *\n   * @public\n   * @function\n   * @param {M.Control} control to compare\n   * @api stable\n   */\n  equals(obj) {\n    let equals = false;\n    if (obj instanceof ReferenceLocatorCatastroControl) {\n      equals = (this.name === obj.name);\n    }\n    return equals;\n  }\n\n  /**\n   * This function destroys this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroy() {\n    this.clear();\n    this.facadeMap_.areasContainer.querySelector('.m-top.m-right').classList.remove('top-extra');\n    this.facadeMap_.getMapImpl().removeControl(this);\n    this.facadeMap_ = null;\n    this.layer_ = null;\n  }\n}\n","/**\n * @module M/plugin/ReferenceLocatorCatastro\n */\nimport 'assets/css/referencelocatorcatastro';\nimport ReferenceLocatorCatastroControl from './referencelocatorcatastrocontrol';\nimport api from '../../api';\n\nexport default class ReferenceLocatorCatastro extends M.Plugin {\n  /**\n   * @classdesc\n   * Main facade plugin object. This class creates a plugin\n   * object which has an implementation Object\n   *\n   * @constructor\n   * @extends {M.Plugin}\n   * @param {Object} impl implementation object\n   * @api stable\n   */\n  constructor(userParameters = {}) {\n    if (M.utils.isNullOrEmpty(userParameters)) {\n      M.exception('No ha especificado ningún parámetro.');\n    }\n    super();\n\n    /**\n     * Facade of the map\n     * @private\n     * @type {M.Map}\n     */\n    this.map_ = null;\n\n    /**\n     * Array of controls\n     * @private\n     * @type {Array<M.Control>}\n     */\n    this.controls_ = [];\n\n    /**\n     * Optional WMS Catastro Layer\n     * @private\n     * @type {M.Layer.WMS}\n     */\n    this.catastroLayer_ = null;\n\n    /**\n     * RCCOOR_url\n     * @private\n     * @type {String}\n     */\n    const defectRCCOOR = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_RCCOOR';\n    this.RCCOOR_url = userParameters.RCCOOR_url != null ? userParameters.RCCOOR_url : defectRCCOOR;\n\n\n    /**\n     * CMC_url\n     * @private\n     * @type {String}\n     */\n    const defectCMC = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejeroCodigos.asmx/ConsultaMunicipioCodigos';\n    this.CMC_url = userParameters.CMC_url != null ? userParameters.CMC_url : defectCMC;\n\n    /**\n     * DNPRC_url\n     * @private\n     * @type {String}\n     */\n    const defectDNPRC = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejeroCodigos.asmx/Consulta_DNPRC_Codigos';\n    this.DNPRC_url = userParameters.DNPRC_url != null ? userParameters.DNPRC_url : defectDNPRC;\n\n    /**\n     * CPMRC_url\n     * @private\n     * @type {String}\n     */\n    const defectCPMRC = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCoordenadas.asmx/Consulta_CPMRC';\n    this.CPMRC_url = userParameters.CPMRC_url != null ? userParameters.CPMRC_url : defectCPMRC;\n\n    /**\n     * DNPPP_url\n     * @private\n     * @type {String}\n     */\n    const defectDNPP = 'http://ovc.catastro.meh.es/ovcservweb/OVCSWLocalizacionRC/OVCCallejeroCodigos.asmx/Consulta_DNPPP_Codigos';\n    this.DNPPP_url = userParameters.DNPPP_url != null ? userParameters.DNPPP_url : defectDNPP;\n\n    /**\n     * catastroWMS\n     * @private\n     * @type {Object}\n     */\n    this.catastroWMS = userParameters.catastroWMS || {};\n\n    /**\n     * Metadata from api.json\n     * @private\n     * @type {Object}\n     */\n    this.metadata_ = api.metadata;\n  }\n\n  /**\n   * This function adds this plugin into the map\n   *\n   * @public\n   * @function\n   * @param {M.Map} map the map to add the plugin\n   * @api stable\n   */\n  addTo(map) {\n    this.config_ = {\n      RCCOOR_url: this.RCCOOR_url,\n      CMC_url: this.CMC_url,\n      DNPRC_url: this.DNPRC_url,\n      CPMRC_url: this.CPMRC_url,\n      DNPPP_url: this.DNPPP_url,\n      catastroWMS: this.catastroWMS,\n    };\n    this.controls_.push(new ReferenceLocatorCatastroControl(this.config_));\n    this.map_ = map;\n    map.areasContainer.querySelector('.m-top.m-right').classList.add('top-extra');\n    this.panel_ = new M.ui.Panel('panelReferenceLocatorCatastro', {\n      className: 'm-catastro',\n      collapsedButtonClass: 'g-catastropanel-button-closed',\n      collapsible: true,\n      position: M.ui.position.TL,\n      tooltip: 'Búsqueda catastral',\n    });\n    this.panel_.on(M.evt.ADDED_TO_MAP, (html) => {\n      M.utils.enableTouchScroll(html);\n    });\n    this.panel_.addControls(this.controls_);\n    map.addPanels(this.panel_);\n\n    // Capa WMS opcional de Catastro\n    if (this.config_.catastroWMS.wms_url && this.config_.catastroWMS.name) {\n      this.catastroLayer_ = new M.layer.WMS({\n        url: this.config_.catastroWMS.wms_url,\n        name: this.config_.catastroWMS.name,\n        legend: 'Catastro',\n        transparent: true,\n        tiled: false,\n      });\n      this.map_.addWMS(this.catastroLayer_);\n    }\n\n    const that = this;\n    this.controls_[0].on(M.evt.ADDED_TO_MAP, () => {\n      that.fire(M.evt.ADDED_TO_MAP);\n    });\n  }\n\n  /**\n   * This function destroys this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  destroy() {\n    this.map_.removeControls(this.controls_);\n    [this.map_, this.controls_, this.panel_] = [null, null, null];\n  }\n\n  /**\n   * This function returns the controls instanced in this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getControls() {\n    return this.controls_;\n  }\n\n  /**\n   * This functions gets results layer\n   * @public\n   * @function\n   * @api\n   */\n  getResultsLayer() {\n    return this.controls_[0].getLayer();\n  }\n\n  /**\n   * This function returns the controls instanced in this plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getWMSCatastroLayer() {\n    return (this.catastroLayer_);\n  }\n\n  /**\n   * @getter\n   * @public\n   */\n  get name() {\n    return 'referencelocatorcatastro';\n  }\n\n  /**\n   * This function gets metadata plugin\n   *\n   * @public\n   * @function\n   * @api stable\n   */\n  getMetadata() {\n    return this.metadata_;\n  }\n}\n","import M$plugin$ReferenceLocatorCatastro from './/facade/js/referencelocatorcatastro';\nimport M$control$ReferenceLocatorCatastroControl from './/facade/js/referencelocatorcatastrocontrol';\nimport M$impl$control$ReferenceLocatorCatastroControl from './/impl/ol/js/referencelocatorcatastrocontrol';\n\nif (!window.M.plugin) window.M.plugin = {};\nif (!window.M.control) window.M.control = {};\nif (!window.M.impl) window.M.impl = {};\nif (!window.M.impl.control) window.M.impl.control = {};\nwindow.M.plugin.ReferenceLocatorCatastro = M$plugin$ReferenceLocatorCatastro;\nwindow.M.control.ReferenceLocatorCatastroControl = M$control$ReferenceLocatorCatastroControl;\nwindow.M.impl.control.ReferenceLocatorCatastroControl = M$impl$control$ReferenceLocatorCatastroControl;\n"],"sourceRoot":""}